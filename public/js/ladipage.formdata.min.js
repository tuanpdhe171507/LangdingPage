LadiPageScriptV2.prototype.parseFormCheckoutProduct=function(e){var t={};try{t=JSON.parse(Base64.decode(e.getAttribute("data-product")))}catch(n){try{t=JSON.parse(e.getAttribute("data-product"))}catch(e){console.error(e)}}return t},LadiPageScriptV2.prototype.sendFormCheckout=function(e,t){var n=this,a=(e=n.findAncestor(e,"ladi-element")).getAttribute("data-payment");a=JSON.parse(a);var i,o=e.querySelectorAll('[data-form-checkout-item="product"] div[data-product]'),r=[];if(1===o.length){var c=n.findAncestor(o[0],"ladi-form-checkout-box");(z=n.parseFormCheckoutProduct(c)).quantity=1;var d=c.querySelector(".ladi-form-checkout-payment-quantity input");isEmptyLadiPage(d)||(z.quantity=parseInt(d.value)||z.quantity),r.push(z)}else r=Array.from(e.querySelectorAll('[data-form-checkout-item="product"] .ladi-form-checkout-product-check.checked')).map(function(e){var t=n.findAncestor(e,"ladi-form-checkout-box"),a=n.parseFormCheckoutProduct(t);a.quantity=1;var i=t.querySelector(".ladi-form-checkout-payment-quantity input");return isEmptyLadiPage(i)||(a.quantity=parseInt(i.value)||a.quantity),a});(i=Array.from(e.querySelectorAll('[data-form-checkout-item="bump_offer"] .ladi-form-checkout-bump-offer-check.multiple.checked')).map(e=>{const t=e.closest(".ladi-form-checkout-bump-offer-product");return{...isEmptyLadiPage(t)?null:n.parseFormCheckoutProduct(t),quantity:1}})).length>0&&Array.prototype.push.apply(r,i);var s=isObjectLadiPage(n.runtime.payment_setting)?n.runtime.payment_setting:{},u=t.setFormData(e,!1),l=u.formDataObject,p=(u=t.setFormDataObjectThankyou()).formDataObjectThankyou,m=u.formDataObjectConvertThankyou,_=isEmptyLadiPage(l.name)?"":l.name,g=isEmptyLadiPage(l.email)?"":l.email,f=isEmptyLadiPage(l.phone)?"":l.phone,h=isEmptyLadiPage(l.message)?"":l.message,y=!isEmptyLadiPage(isEmptyLadiPage(l.i_agree_terms_and_conditions)?"":l.i_agree_terms_and_conditions),v=isEmptyLadiPage(l.country)?"":l.country.split(":")[0],E=isEmptyLadiPage(l.state)?"":l.state.split(":")[0],k=isEmptyLadiPage(l.ward)?"":l.ward.split(":")[0],L=isEmptyLadiPage(l.district)?"":l.district.split(":")[0],P=isEmptyLadiPage(l.address)?"":l.address.split(":")[0],b=!1,A=!1,w=!1,O=!0,S=0,T=isObjectLadiPage(n.runtime.tmp.form_data_value_all)?n.runtime.tmp.form_data_value_all:{},x="true"===e.getAttribute("is_auto_funnel");if(t.checkValidate(e,!1,null)){var N=function(a,i){var o=s.thankyou_type,r=s.thankyou_value,c=!1;n.runtime.has_popupx&&n.runtime.tmp.popupx_is_inline&&(c=!0);var d=0,u=n.runtime.eventData[e.id]["option.form_auto_funnel"],l="";o==n.const.FORM_THANKYOU_TYPE.default&&(isEmptyLadiPage(r)||n.showMessage(r,m)),o==n.const.FORM_THANKYOU_TYPE.popup&&(u&&n.setDataReplaceElement(!1,!1,m,r),window.ladi(r).show(!1,{formThankyouPopupXInline:c})),o!=n.const.FORM_THANKYOU_TYPE.url&&o!=n.const.FORM_THANKYOU_TYPE.url_default||isEmptyLadiPage(a)||(r=window.ladi(a).encode_thankyou_url(),l=function(e,t,a){var i=Object.assign(n.copy(T),n.copy(p),a||{});i=Object.assign(i,{qr_code:n.runtime.tmp.current_qr_code_link}),e=window.ladi(e).get_url(i,t,!1);var o=new URL(e,window.location.origin);return Object.keys(i).forEach(function(t){o.searchParams.has(t)||e.includes("{{"+t+"}}")||void 0!==i[t]&&null!==i[t]&&""!==i[t]&&o.searchParams.append(t,i[t])}),o.toString()}(r,u,{ls_data:i}),d+=1e3,n.runTimeout(function(){window.ladi(l).open_url()},d)),t.resetFormValue(e.querySelector(".ladi-form"))},C=function(e,t){"Success"==e&&N(t.thanks_url,t.ls_data),"Canceled"==e&&n.showMessage(n.const.LANG.FORM_CHECKOUT_ORDER_CANCEL)};window.formCheckoutDownloadQRCode=function(){const e=document.getElementById("form-checkout-bank-qr").src;fetch(e).then(e=>e.blob()).then(e=>{const t=new FileReader;t.onloadend=function(){const e=t.result,n=document.createElement("a");n.href=e,n.download="qr_code.png",document.body.appendChild(n),n.click(),document.body.removeChild(n)},t.readAsDataURL(e)}).catch(e=>console.error("Error downloading image:",e))},window.formCheckoutCopyToClipboard=function(e){const t=e.closest(".info-row"),n=t?t.querySelector(".info-value"):null;if(n){const t=n.textContent.trim(),a=document.createElement("input");a.style.position="absolute",a.style.left="-9999px",document.body.appendChild(a),a.value=t,a.select(),document.execCommand("copy"),document.body.removeChild(a);const i=e.querySelector(".tooltiptext.right"),o=i.getAttribute("tooltiptext");i.setAttribute("tooltiptext","Copied to clipboard!"),i.style.visibility="visible",i.style.opacity="1",setTimeout(()=>{i.setAttribute("tooltiptext",o),i.style.visibility="hidden",i.style.opacity="0"},2e3)}else console.error("The .info-value element was not found.")},window.formCheckoutClosePopupQRCode=function(){b=!0;var e=document.querySelector(".ladipage-message");e&&e.remove();var t=document.querySelector("body .ladi-wraper");t&&(t.style.display="block"),n.removeTimeout(S),S=null},window.clickConfirmBankedCheckout=function(){console.log("clickConfirmBankedCheckout")};var q=function(e,t){t&&delete n.runtime.tmp.current_qr_code_link,b=!1;var a="form-checkout-bank-qr",i=e.bank_info.banks[0].autoConfirmPayment;const o=document.querySelector("body .ladi-wraper"),r=window.innerWidth<=768;if(o&&r?o.style.display="none":o&&(o.style.display=""),isEmptyLadiPage(document.getElementById(a))){LadiPageScript.showMessage(`\n            <style>\n                #backdrop-popup {\n                    opacity: 0 !important; \n                    pointer-events: none !important;\n                }\n                body {\n                    position: initial !important;\n                    width: initial !important;\n                }\n                .ladipage-message-box {\n                    font-family: "Roboto", sans-serif;\n                    border-radius: 0 !important;\n                    width: 100% !important;\n                    max-width: 100% !important;\n                    height: 100% !important;\n                    top: 0 !important;\n                    left: 0 !important;\n                    background: transparent !important;\n                    display: flex !important;\n                    justify-content: center;\n                    align-items: center;\n                }\n                .ladipage-message-box > span {\n                   display: none !important;\n                }\n                .ladipage-message-text {\n                    display: block !important;\n                    width: fit-content;\n                    height: fit-content;\n                    margin-top: 0 !important;\n                    padding: 24px !important;\n                    background: #fff;\n                    border-radius: 8px;\n                    position: relative;\n                }\n                .cursor {\n                    cursor: pointer;\n                }\n                .ladipage-message-text .ladipage-message-title {\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                    flex-direction: column;\n                    row-gap: 8px;\n                }\n                .ladipage-message-text .text-title {\n                    color: #3B3B44;\n                    font-weight: 600;\n                    font-size: 18px;\n                }\n                .ladipage-message-text .text-sub-title {\n                    font-weight: 400;\n                    font-size: 14px;\n                    color: #3C72F9;\n                }\n                .ladipage-message-text .sub-title {\n                    display: flex;\n                    align-items: center;\n                    gap: 8px;\n                }\n                .ladipage-message-title .count-down {\n                    display: flex;\n                    gap: 8px;\n                }\n\n                .ladipage-message-title .close-popup {\n                    color: #8A3FFC;\n                }\n                .ladipage-message-text .ladipage-message-content {\n                    display: flex;\n                    gap: 16px;\n                    padding-top: 12px;\n                }\n                .ladipage-message-text .form-qr-code {\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    row-gap: 12px;\n                    max-width: 300px;\n                }\n\n                .ladipage-message-text .form-qr-code .text-qr-code {\n                    color: #3B3B44;\n                    font-weight: 600;\n                    font-size: 14px;\n                }\n\n                .ladipage-message-content .download-qr-code {\n                    display: flex;\n                    gap: 4px;\n                }\n                .ladipage-message-content .download-qr-code img {\n                    filter: invert(6%) sepia(40%) saturate(5000%) hue-rotate(242deg) brightness(89%) contrast(90%);\n                }\n                .ladipage-message-content .form-qr-code .qr-text-document {\n                    color: #566577;\n                    font-size: 14px;\n                    font-weight: 400;\n                    text-align: center;\n                }\n                .ladipage-message-content .form-qr-code .qr-text-document span {\n                    font-size: 14px;\n                    color: #566577;\n                }\n                .ladipage-message-text .form-qr-code .text-download-qr {\n                    color: #7C4AF2;\n                    font-size: 12px;\n                }\n\n                .ladipage-message-content .form-bank-content {\n                    display: flex;\n                    flex-direction: column;\n                    align-items: center;\n                    row-gap: 14px;\n                    max-width: 396px;\n                }\n\n                .ladipage-message-content .form-bank-content .title {\n                    color: #3B3B44;\n                    font-weight: 400;\n                    font-size: 14px;\n                }\n                .ladipage-message-content .form-bank-content .title span {\n                    font-weight: 600;\n                    color: #3B3B44;\n                    font-size: 14px;\n                }\n                \n                .ladipage-message-text span { \n                    text-align: center;\n                    display: inline !important;\n                    background-color: transparent !important;\n                    padding: 0 !important;\n                    margin-top: 10px;\n                }\n                .text-not-config {\n                    font-size: 14px;\n                    color: #3B3B44;\n                    text-align: center;\n                    max-width: 632px;\n                }\n                \n                .transfer-container {\n                    border: 1px solid #e0e0e0;\n                    border-radius: 8px;\n                    padding: 0 12px 12px;\n                    background-color: #fff;\n                    min-width: 396px;\n                }\n                .transfer-container .logo-bank {\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                }\n                .transfer-header {\n                    text-align: center;\n                    font-size: 16px;\n                    font-weight: 600;\n                    margin-bottom: 20px;\n                }\n                .info-row {\n                    display: flex;\n                    justify-content: start;\n                    align-items: center;\n                    padding: 8px 0;\n                    border-bottom: 1px solid #F1F1F1;\n                }\n                .info-row:last-child {\n                    border-bottom: none;\n                }\n                .info-label {\n                    color: #64768D;\n                    font-size: 14px;\n                    font-weight: 400;\n                    min-width: 80px;\n                }\n                .info-value {\n                    color: #3B3B44;\n                    font-weight: 600;\n                    font-size: 14px;\n                    margin-left: 24px;\n                }\n                .note {\n                    background-color: #FFF3D0;\n                    padding: 12px;\n                    border-radius: 4px;\n                    margin-top: 12px;\n                    font-size: 14px;\n                    font-weight: 400;\n                    color: #000000;\n                }\n                .note span {\n                    color: #000;\n                    font-weight: 600;\n                }\n                .copy-button {\n                    margin-left: 10px;\n                    background-color: #F1F1F1;\n                    width: 28px;\n                    display: flex;\n                    justify-content: center;\n                    border-radius: 4px;\n                    padding: 2px;\n                    position: relative;\n                }\n                \n                .tooltiptext.right {\n                    visibility: hidden;\n                    border-radius: 2px;\n                    padding: 5px 0;\n                    position: absolute;\n                    z-index: 900000090;\n                    width: 100%;\n                    height: 100%;\n                    top: 0;\n                    left: 0;\n                    pointer-events: none;\n                    line-height: 20px;\n                    opacity: 0;\n                    transition: opacity 1s;\n                }\n                .tooltiptext {\n                    font-size: 14px;\n                }\n                .tooltiptext.right::before {\n                    content: attr(tooltiptext);\n                    position: absolute;\n                    right: -6px;\n                    top: -6px;\n                    background: #0E233C;\n                    color: #fff;\n                    padding: 5px 10px;\n                    min-width: 20px;\n                    max-width: 200px;\n                    margin: auto;\n                    width: max-content;\n                    text-align: center;\n                    transform: translateX(100%) translateY(0%);\n                    word-break: break-all;\n                    border-radius: 6px;\n                }\n                .tooltiptext.right::after {\n                    content: "";\n                    position: absolute;\n                    top: 4px;\n                    right: -7px;\n                    border-width: 6px;\n                    border-style: solid;\n                    border-color: transparent black transparent transparent;\n                }\n\n                .copy-button:hover .tooltiptext.right {\n                    visibility: visible !important;\n                    opacity: 1 !important;\n                }\n                .ldicon-circle-close-fill {\n                    width: 18px;\n                    height: 18px;\n                    cursor: pointer;\n                    pointer-events: unset !important;\n                    background-color: #566577;\n                    mask-image: url(https://w.ladicdn.com/ladiui/icons/new-ldicon-close-fill-2.svg);\n                    mask-size: contain;\n                    mask-repeat: no-repeat;\n                    mask-position: center;\n                    position: absolute;\n                    top: 2%;\n                    right: 3%;\n                }\n                .ladipage-message-close {\n                    display: none !important;\n                }\n                \n                .btn-confirm {\n                    background-color: #1C00C2;\n                    color: #fff;\n                    padding: 8px 12px;\n                    border-radius: 4px;\n                    cursor: pointer;\n                }\n\n                #payment-guide {\n                    max-width: 712px;\n                    text-align: center;\n                }\n                @media only screen and (max-width: 768px) {\n                    .ladipage-message {\n                        height: auto;\n                        position: absolute;\n                    }\n                    .ladipage-message-text {\n                        margin: auto;\n                        overflow-y: scroll !important;\n                        max-height: 100vh;\n                    }\n\n                    .ladipage-message .ladipage-message-box {\n                        position: absolute !important;\n                        border: none;\n                    }\n                    .ladipage-message-text .ladipage-message-content {\n                        flex-direction: column-reverse;\n                        justify-content: center;\n                        align-items: center;\n                    }\n                }\n            </style>\n            <div class="ladipage-message-title">\n                    <i onclick="formCheckoutClosePopupQRCode()" class="close-popup ladiui icon close ldicon-circle-close-fill"></i>\n                    <div class="text-title">Thanh toán chuyển khoản ngân hàng</div>\n                    ${i?'\n                        <div class="sub-title">\n                            <div class="text-sub-title">Đang chờ thanh toán</div>\n                            <div class="count-down">\n                                <div id="countdown-timer"></div>\n                            </div>\n                            <img src="https://w.ladicdn.com/ladiui/icons/ldicon-loading2.svg" width="20" height="20" alt="Loading" />\n                        </div>\n\n                        <div id="countdown-message" style="display: none;">\n                            Có vẻ như tiến trình xác nhận thanh toán tự động diễn ra lâu hơn bình thường hoặc phát sinh sự cố ngoài ý muốn. Bạn có thể liên hệ người bán để được hỗ trợ thông tin.\n                        </div>\n\n                    ':""}\n                    ${function(){const t=e.bank_info.payment_guide.replace(/\n/g,"<br>");return htmlContent='<div id="payment-guide">'+t+"</div>"}()}\n            </div>\n\n            <div class="ladipage-message-content">\n                <div class="form-qr-code">\n                            <div class="text-qr-code">Quét mã QR thanh toán</div>\n                            ${function(){if(isObjectLadiPage(e.bank_info)){var t=e.bank_info.base_64_qrCode?"data:image/png;base64,"+e.bank_info.base_64_qrCode:e.bank_info.qr_url;return n.runtime.tmp.current_qr_code_link=t,`<img id="${a}" src="${t}" width="212" height="212" alt="QRCode">`}return""}()}\n                            <div style="display: none;" class="download-qr-code cursor" onclick="formCheckoutDownloadQRCode()">\n                                <div class="text-download-qr">Tải xuống mã QR</div>\n                                <img width="14" height="14" src="https://w.ladicdn.com/ladiui/icons/ldicon-download.svg" />\n                            </div>\n                            <div class="qr-text-document">Mở app ngân hàng hoặc ví điện tử của bạn sau đó chọn <span>quét mã QR</span> để thực hiện thanh toán.</div>\n                </div>\n                ${function(){try{return`\n                        <div class="form-bank-content">\n                        <div class="title">\n                            <span>Chuyển khoản thủ công</span> theo thông tin\n                        </div>\n                        \n                        <div class="transfer-container">\n                            <div class="tranfer-content-detail">\n                                <div class="logo-bank">\n                                    <img src="${e.bank_info.banks[0].bank.logo}" width="128" height="48" />\n\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Ngân hàng</div>\n                                    <div class="info-value">${e.bank_info.banks[0].bank.shortName}</div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Thụ hưởng</div>\n                                    <div class="info-value">${e.bank_info.banks[0].accountName}</div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Số tài khoản</div>\n                                    <div class="info-value">${e.bank_info.banks[0].accountNumber}</div>\n                                    <div class="copy-button cursor" onclick="formCheckoutCopyToClipboard(this)">\n                                        <img src="https://w.ladicdn.com/ladiui/icons/ldicon-copy.svg" width="16" height="16" alt="Copy" />\n                                        <div class="tooltiptext right" tooltiptext="Copy"></div>\n                                    </div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Số tiền</div>\n                                    <div class="info-value">${n.formatCurrency(e.bank_info.amount,e.bank_info.currency_symbol,!0)}</div>\n                                    <div class="copy-button cursor" onclick="formCheckoutCopyToClipboard(this)">\n                                        <img src="https://w.ladicdn.com/ladiui/icons/ldicon-copy.svg" width="16" height="16" alt="Copy" />\n                                        <div class="tooltiptext right" tooltiptext="Copy"></div>\n                                    </div>\n                                </div>\n                                <div class="info-row">\n                                    <div class="info-label">Nội dung CK</div>\n                                    <div class="info-value">\n                                        ${i?`${e.bank_info.banks[0].transferContentPrefix}${e.bank_info.reference_no}`:`${function(e){const t=e.banks[0].transactionContent,n={"{{customer_full_name}}":e.customer_full_name||"","{{customer_phone}}":e.customer_phone||"","{{MaDonHang}}":e.reference_no||""};return t.replace(/{{(.*?)}}/g,(e,t)=>n[e]||"")}(e.bank_info)}`}\n                                    </div>\n                                    <div class="copy-button cursor" onclick="formCheckoutCopyToClipboard(this)">\n                                        <img src="https://w.ladicdn.com/ladiui/icons/ldicon-copy.svg" width="16" height="16" alt="Copy" />\n                                        <div class="tooltiptext right" tooltiptext="Copy"></div>\n                                    </div>\n                                </div>\n                                ${i?`\n                                    <div class="note">\n                                        Lưu ý: Vui lòng giữ nguyên nội dung <span>${e.bank_info.banks[0].transferContentPrefix}${e.bank_info.reference_no}</span> để xác nhận thanh toán tự động\n                                    </div>\n                                    `:""}\n    \n                            </div>\n                        </div>\n                        \n                    </div>\n                    `}catch(e){return""}}()}\n            </div>\n        `)}!A&&i&&(!function(e){const t=document.querySelector(".count-down"),a=document.getElementById("countdown-timer"),i=document.getElementById("countdown-message"),o=document.querySelector(".close-popup"),r=document.querySelector(".sub-title");let c=Date.now()+60*e*1e3;a.style.display="block",i.style.display="none",o.style.display="block",function e(){const d=Math.max(0,c-Date.now()),s=Math.floor(d/6e4),u=Math.floor(d%6e4/1e3);a.textContent=`${String(s).padStart(2,"0")} phút ${String(u).padStart(2,"0")} giây`,d>0?S=n.runTimeout(e,1e3):(i.style.textAlign="center",i.style.display="block",i.style.color="#E01A1A",i.style.maxWidth="632px",o.style.display="block",t.style.display="none",r.style.display="none",w=!0)}()}(5),A=!0);var c=new XMLHttpRequest;c.open("POST",n.const.API_LADISALE_CHECKOUT_GET_ORDER_STATUS),c.addEventListener("readystatechange",function(){if(4===this.readyState)try{var t=JSON.parse(this.responseText);if(200!=t.code)throw new TypeError("api error");if("Pending"==t.data.payment_status||"OnHold"==t.data.payment_status)throw new TypeError("fetch api");C(t.data.payment_status,e)}catch(t){setTimeout(function(){!b&&q(e,!1)},1e4)}}),c.setRequestHeader("content-type","application/json"),!O||b||w||(O=i,c.send(JSON.stringify({ls_data:e.ls_data})))};isEmptyLadiPage(n.runtime.tmp.form_checkout_order_id)&&(n.runtime.tmp.form_checkout_order_id=n.randomString(10)),n.showLoadingBlur();var R=localStorage.getItem("previousSubmission");if(R)var D=JSON.parse(R);else D={customer_name:null,customer_email:null,customer_phone:null,variants:[],data_payment:{code:null,type:null,bank_code:null}};var F,I,M,j=r.map(function(t){return{product_id:t.product_id,product_variant_id:t.product_variant_id,quantity:t.quantity,product_type:t.product_type||"",store_id:t.store_id_product,up_sell_ids:(n=t.product_variant_id,a=e.id,i=[],document.querySelectorAll("#"+a+" .ladi-form-checkout-box").forEach(function(e){try{var t=e.getAttribute("data-product");if(JSON.parse(Base64.decode(t)).product_variant_id==n&&e.querySelector(".ladi-form-checkout-product-check.checked")){var a=e.querySelector(".ladi-form-checkout-combo-product");a&&a.querySelectorAll("[data-item-variant-id]").forEach(function(e){var t=e.getAttribute("data-item-variant-id");t&&""!==t.trim()&&i.push(t)})}}catch(e){}}),i.filter(function(e,t,n){return n.indexOf(e)===t}))};var n,a,i});try{var U={code:a.code||null,method_name:a.method_name||null},Y=D.variants.length!==j.length;if(!Y)for(var B=0;B<j.length;B++)!D.variants[B]||D.variants[B].product_id===j[B].product_id&&D.variants[B].product_variant_id===j[B].product_variant_id&&D.variants[B].quantity===j[B].quantity||(Y=!0);var G=function(e){var t={type:null,bank_code:null};for(var n in e)e.hasOwnProperty(n)&&"object"==typeof e[n]&&null!==e[n]&&("type"in e[n]&&(t.type=e[n].type),"bank_code"in e[n]&&(t.bank_code=e[n].bank_code));return t}(a);U.type=G.type,U.bank_code=G.bank_code;var H=D.customer_name!==_||D.customer_email!==g||D.customer_phone!==f,J=D.data_payment.code!==U.code||D.data_payment.type!==U.type||D.data_payment.bank_code!==U.bank_code;Y&&(H=!0);var K=H;!H&&J&&(K=!1);var $=e.id;let X=n.runtime.tmp[$+"_data_discount_coupon_selected"]||null,Z=n.runtime.tmp[$+"_data_discount_shipping_selected"]||null,ee=n.runtime.tmp[$+"_data_method_shipping_selected"]||null;var V="";function W(e){var t=window.ladi(e).get_cookie();return isEmptyLadiPage(t)?"":t}try{V=document.getElementById($).getAttribute("data-fb-event-id")}catch(te){}var z=JSON.stringify({order_note:h,accept_policy:y,tracking_script:(F=[],I="ladi_run_tracking_"+n.randomString(10),M=`window.${I} = function (data) {\n                    try {\n                        new Function(data.str)();\n                        console.log(data.str);\n                    } catch (e) {\n                        setTimeout(function () {\n                            window.${I}(data);\n                        }, 100);\n                    }\n                };`,F.push(M),isArrayLadiPage(n.runtime.tmp.form_checkout_tracking_script)&&n.runtime.tmp.form_checkout_tracking_script.forEach(function(e){F.push(`window.${I}(${JSON.stringify({str:e})});`)}),1==F.length&&(F=[]),F.join("")),tracking_conversion_api:n.runtime.tmp.form_checkout_tracking_conversion_api||[],thank_url:s.thankyou_type==n.const.FORM_THANKYOU_TYPE.url_default?"":s.thankyou_value,is_auto_funnel:x,source_from:"LP",invoiceInfo:{isEnable:!1},url:window.location.href,gateway:a,product_one_page:!0,lang:"vi",domain:window.location.hostname,path:window.location.pathname.substring(1),discount_code:X?X.discount_code:null,path_type:"product",cart_token:!K&&window.ladi("CART_TOKEN_FORM_CHECKOUT").get_cookie(),checkout_token:!K&&window.ladi("CHECKOUT_TOKEN_FORM_CHECKOUT").get_cookie(),customer_first_name:_,customer_email:g,customer_phone:f,is_export_invoice:!1,variants:j,utm:{url_pathname:window.location.pathname,url_search:window.location.search,url_page:window.location.href,user_agent:navigator.userAgent,data_fbp:W("_fbp"),data_fbc:W("_fbc"),event_id:V,ref:window.ladi("ladi_ref").get_cookie()},custom_fields_checkout:Object.entries(l).filter(([e])=>!["name","email","phone","message","address","state","district","ward","country","i_agree_terms_and_conditions"].includes(e)).map(function(e){return{name:e[0],value:e[1]}}),customer_country_code:v,customer_state_id:E,customer_district_id:L,customer_ward_id:k,customer_address:P,shipping_country_code:v,shipping_state_id:E,shipping_district_id:L,shipping_ward_id:k,shipping_address:P,shipping_method_id:ee?ee.shipping_method_id:null,discount_shipping_code:Z?Z.code:null}),Q=new XMLHttpRequest;Q.addEventListener("readystatechange",function(){4===this.readyState&&(!function(e){try{var t=JSON.parse(e);if(200!=t.code||!isObjectLadiPage(t.data))return n.showMessage(t.message);if(window.ladi_fbq("track","InitiateCheckout",{value:r.reduce(function(e,t){return e+t.price*t.quantity},0),currency:n.runtime.currency,content_ids:r.map(function(e){return e.product_variant_id}),num_items:r.reduce(function(e,t){return e+t.quantity},0),products_name:r.map(function(e){return e.name})}),t.data,!isEmptyLadiPage(t.data.redirect_url)&&isEmptyLadiPage(t.data.vnptEPayData)&&(!isObjectLadiPage(t.data.bank_info)||isEmptyLadiPage(t.data.bank_info.base_64_qrCode)))return void n.runTimeout(function(){window.location.href=t.data.redirect_url},1e3);if(isObjectLadiPage(t.data.bank_info)&&!t.data.bank_info.qr_url&&!isEmptyLadiPage(t.data.bank_info.base_64_qrCode))return void q(t.data,!0);if(isObjectLadiPage(t.data.bank_info)&&!isEmptyLadiPage(t.data.bank_info.qr_url)&&!isEmptyLadiPage(t.data.ls_data)&&!b)return window.ladi("CART_TOKEN_FORM_CHECKOUT").set_cookie(t.data.cart_token,3),window.ladi("CHECKOUT_TOKEN_FORM_CHECKOUT").set_cookie(t.data.checkout_token,3),void(0!==t.data.bank_info.amount?q(t.data,!0):N(t.data.thanks_url,t.data.ls_data));if(t.data.vnptEPayData){var a=document.createElement("div");a.style.display="none",a.appendChild(function(e={}){var t=document.createElement("form");return t.id="megapayForm",t.name="megapayForm",t.method="POST",[{name:"invoiceNo",value:e.invoice_no},{name:"amount",value:e.amount},{name:"currency",value:e.currency||"VND"},{name:"goodsNm",value:e.product_name},{name:"buyerPhone",value:e.buyer_phone},{name:"buyerAddr",value:""},{name:"buyerCity",value:""},{name:"buyerState",value:""},{name:"buyerPostCd",value:""},{name:"buyerCountry",value:""},{name:"fee",value:""},{name:"receiverFirstNm",value:""},{name:"receiverLastNm",value:""},{name:"receiverPhone",value:""},{name:"receiverAddr",value:""},{name:"receiverCity",value:""},{name:"receiverState",value:""},{name:"receiverPostCd",value:""},{name:"receiverCountry",value:"VN"},{name:"description",value:e.description},{name:"callBackUrl",value:e.redirect_url},{name:"notiUrl",value:e.notify_url},{name:"merId",value:e.mer_id},{name:"reqDomain",value:e.url},{name:"userLanguage",value:e.user_language},{name:"merchantToken",value:e.token},{name:"payToken",value:""},{name:"timeStamp",value:e.time_stamp},{name:"merTrxId",value:e.mer_trx_id},{name:"windowType",value:"1"},{name:"windowColor",value:"#0B3B39"},{name:"userFee",value:""},{name:"vaCondition",value:"03"},{name:"payType",value:e.type},{name:"payOption",value:""},{name:"bankCode",value:e.bank_code},{name:"goodsAmount",value:""},{name:"buyerLastNm",value:""},{name:"buyerFirstNm",value:""},{name:"buyerEmail",value:e.buyer_email},{name:"vaStartDt",value:e.va_start_date},{name:"vaEndDt",value:e.va_end_date}].forEach(function(e){var n=document.createElement("input");n.type="hidden",n.name=e.name,n.value=e.value,t.appendChild(n)}),t}(t.data.vnptEPayData)),document.body.appendChild(a),window.openPayment(1,t.data.vnptEPayData.domain)}N(t.data.thanks_url,t.data.ls_data)}catch(e){return console.log(e),n.showMessage(n.const.LANG.REQUEST_SEND_ERROR)}}(this.responseText),n.hideLoadingBlur())}),Q.open("POST",n.const.API_LADISALE_CHECKOUT_PAYMENT),Q.setRequestHeader("Content-Type","application/json"),Q.send(z),D={customer_name:_,customer_email:g,customer_phone:f,variants:j,data_payment:U},localStorage.setItem("previousSubmission",JSON.stringify(D))}catch(ne){n.hideLoadingBlur()}}},LadiPageScriptV2.prototype.eventFormCheckoutSelectPaymentType=function(e){var t=this;t instanceof LadiPageScriptV2||(t=LadiPageScript),e.stopPropagation();var n=t.findAncestor(e.target,"ladi-form-checkout-box"),a=t.findAncestor(e.target,["ladi-form","ladi-element"]);isObjectLadiPage(LadiPageScript.runtime.tmp.isObjectCheck)||(LadiPageScript.runtime.tmp.isObjectCheck={});var i=LadiPageScript.runtime.tmp.isObjectCheck[a.id];delete LadiPageScript.runtime.tmp.isObjectCheck[a.id];var o=!1,r={};try{r=t&&t.runtime&&isObjectLadiPage(t.runtime.payment_setting)?t.runtime.payment_setting:{}}catch(e){console.error("Lỗi parse payment_setting:",e)}if(Array.isArray(r.list_payment)&&(o=r.list_payment.some(e=>"VNPT_EPAY"===e.payment_code)),console.log("debug hasVNPT_EPAY:",o),o){var c=document.createElement("script");c.type="text/javascript",c.rel="preload",c.src="https://pg.megapay.vn/pg_was/js/payment/layer/paymentClient.js",c.async=!0,document.head.appendChild(c)}if(!document.querySelector('script[src="https://code.jquery.com/jquery-1.11.1.min.js"]')){var d=document.createElement("script");d.type="text/javascript",d.rel="preload",d.src="https://code.jquery.com/jquery-1.11.1.min.js",d.async=!0,document.head.appendChild(d)}t.showMessage('\n    <style>\n        .ladipage-message {\n            background: transparent !important;\n        }\n        .ladipage-message-box {\n            border-radius: 0 !important;\n            width: 100% !important;\n            max-width: 100% !important;\n            height: 100% !important;\n            top: 0 !important;\n            left: 0 !important;\n            background: transparent !important;\n            border: none !important;\n        }\n        .ladipage-message-box > span {\n           display: none !important;\n        }\n        .ladipage-message-text {\n            height: 100%;\n            margin-top: 0 !important;\n            padding: 0 !important;\n        }\n        .ladipage-message .ladipage-message-box iframe {\n            width: 100%;\n            height: 100%;\n        }\n        .ladipage-message-close {\n            display: none !important;\n        }\n    </style>\n    <iframe allow="accelerometer; clipboard-read; clipboard-write; fullscreen; gyroscope; payment; usb"></iframe>\n    ');var s=function(){document.querySelector(".ladipage-message-close").click(),isEmptyLadiPage(a.getAttribute("data-payment"))&&a.setAttribute("data-payment",JSON.stringify({}))},u=function(e){var t=a.querySelector('.ladi-element[data-form-checkout-item="payment"] .ladi-form-checkout-box[data-payment-code="'+e.code+'"] .ladi-form-checkout-payment-content span:last-child');t.hasAttribute("data-old")||t.setAttribute("data-old",t.textContent),isEmptyLadiPage(e.code)?t.textContent=t.getAttribute("data-old"):t.textContent=e.method_title||t.getAttribute("data-old"),isEmptyLadiPage(e.code)||(Array.from(a.querySelectorAll('[data-form-checkout-item="payment"] .ladi-form-checkout-payment-check.checked')).forEach(function(e){e.classList.remove("checked")}),Array.from(a.querySelectorAll('[data-form-checkout-item="payment"] [data-payment-code="'+e.code+'"] .ladi-form-checkout-payment-check')).forEach(function(e){e.classList.add("checked")})),a.setAttribute("data-payment",JSON.stringify(e)),s()},l=document.querySelector(".ladipage-message-text iframe"),p=function(){if(isEmptyLadiPage(l))return;var e=isObjectLadiPage(t.runtime.payment_setting)?t.runtime.payment_setting:{},o=a.hasAttribute("data-payment")?JSON.parse(a.getAttribute("data-payment")):{};o.code=n.getAttribute("data-payment-code");var r=t.runtime.tmp.html_payment_str;const c=a.id,d=document.querySelectorAll(`#${c} .ladi-form-checkout-product-check.multiple.checked`);var p=null;d.forEach(e=>{const n=e.closest(".ladi-form-checkout-box");n&&(p=t.parseFormCheckoutProduct(n))}),l.contentWindow.isFirstClickMethodPayment=i,l.contentWindow.payment_continue=u,l.contentWindow.payment_cancel=s,l.contentWindow.payment_setting=e,l.contentWindow.current_select=o,l.contentWindow.ladi_uid=t.runtime.store_ladiuid,l.contentWindow.end_point_api=t.const.API_LADISALE_LIST_GATEWAY,l.contentWindow.objDataProduct=p,l.contentDocument.open(),l.contentDocument.write(r),l.contentDocument.close()};isEmptyLadiPage(t.runtime.tmp.html_payment_str)?fetch(t.const.URL_LADI_PAYMENT()).then(e=>e.text()).then(e=>{t.runtime.tmp.html_payment_str=e,p()}).catch(e=>{}):p()},LadiPageScriptV2.prototype.checkValidateSendFormCheckout=function(e){var t=this;try{if(0==e.querySelectorAll('[data-form-checkout-item="product"] div[data-product]').length)throw new TypeError("no product")}catch(e){return t.showMessage(t.const.LANG.FORM_VALIDATE_CHECKOUT_PRODUCT),!1}try{var n=JSON.parse(e.getAttribute("data-payment"));if(0==Object.keys(n).length)throw new TypeError("no payment")}catch(n){if(e.querySelectorAll('[data-form-checkout-item="payment"] div[data-payment-code]').length>1)return t.showMessage(t.const.LANG.FORM_VALIDATE_CHECKOUT_PAYMENT);isObjectLadiPage(LadiPageScript.runtime.tmp.isObjectCheck)||(LadiPageScript.runtime.tmp.isObjectCheck={}),delete LadiPageScript.runtime.tmp.isObjectCheck[e.id];var a=e.querySelector('[data-form-checkout-item="payment"] .ladi-form-checkout-payment-content');return a&&a.click(),!1}return!0},LadiPageScriptV2.prototype.runOptionFormCheckout=function(){var e=this,t={state:"",district:"",ward:""},n=function(t){try{var n=e.findAncestor(t,"ladi-form-checkout-box"),a=e.parseFormCheckoutProduct(n);if(isEmptyLadiPage(a.min))throw new TypeError("no min");return parseInt(a.min)||1}catch(e){return 1}},a=function(t){try{var n=e.findAncestor(t,"ladi-form-checkout-box"),a=e.parseFormCheckoutProduct(n);if(isEmptyLadiPage(a.max))throw new TypeError("no max");return parseInt(a.max)||1}catch(e){return 1e6}},i=function(e){var t=parseInt(e.target.value);t<n(e.target)&&(t=n(e.target)),t>a(e.target)&&(t=a(e.target)),e.target.value=t,c(e)},o=function(e){var t=e.target.parentElement.querySelector("input");t.value=(parseInt(t.value)||0)+1,t.value>a(e.target)&&(t.value=a(e.target)),c(e)},r=function(e){var t=e.target.parentElement.querySelector("input");t.value=(parseInt(t.value)||0)-1,t.value<n(e.target)&&(t.value=n(e.target)),c(e)},c=function(n){var a=e.findAncestor(n.target,["ladi-form","ladi-element"]).id;let i=document.querySelectorAll("#"+a+' [data-form-checkout-item="product"] div[data-product]'),o=document.querySelectorAll("#"+a+' [data-form-checkout-item="bump_offer"] .ladi-form-checkout-bump-offer-check.checked'),r=document.querySelectorAll("#"+a+" .ladi-form-checkout-product-check.checked, #"+a+' [data-form-checkout-item="product"] [data-product] .ladi-form-checkout-payment-item > span.checked'),c=document.querySelectorAll("#"+a+" .ladi-form-checkout-bump-offer-check.checked");const d=Array.from(r).concat(Array.from(c));if(1==i.length&&(r=document.querySelectorAll("#"+a+" .ladi-form-checkout-product-check, #"+a+' [data-form-checkout-item="product"] [data-product] .ladi-form-checkout-payment-item > span')),0==r.length){var s=e.findAncestor(n.target,"ladi-form");s.querySelectorAll('[data-form-checkout-item="bump_offer"]').length>0&&(Array.from(s.querySelectorAll('[data-form-checkout-item="bump_offer"] .ladi-form-checkout-bump-offer-check.checked')).forEach(function(e){e.classList.remove("checked")}),c=[])}let u=[];if(1===i.length){const t=i[0].closest(".ladi-form-checkout-box"),n=t.querySelector('.ladi-form-checkout-payment-quantity input[type="number"]');if(t){const a=e.parseFormCheckoutProduct(t),i=isEmptyLadiPage(n)?1:parseInt(n.value);u.push({product_variant_id:a.product_variant_id,quantity:i})}o.forEach(t=>{const n=t.closest(".ladi-form-checkout-bump-offer-product"),a=e.parseFormCheckoutProduct(n);u.push({product_variant_id:a.product_variant_id,quantity:1})})}else d.forEach(t=>{const n=t.closest(".ladi-form-checkout-box, .ladi-form-checkout-bump-offer-product"),a=isEmptyLadiPage(n)?null:n.querySelector('.ladi-form-checkout-payment-quantity input[type="number"]');if(n){const t=e.parseFormCheckoutProduct(n),i=isEmptyLadiPage(a)?1:parseInt(a.value);u.push({product_variant_id:isObjectLadiPage(t)?t.product_variant_id:null,quantity:i})}});0==r.length&&0==c.length&&(u=[]);p(a,{variants:u}),L(n,t)},d=function(n){n.stopPropagation();var a=e.findAncestor(n.target,"ladi-element");if("product"==a.getAttribute("data-form-checkout-item")){var i=e.findAncestor(n.target,"ladi-form-checkout-box"),o=i.querySelector(".ladi-form-checkout-payment-check, .ladi-form-checkout-product-check");if(o){var r=a.querySelectorAll(".ladi-form-item [data-product]");if(o.classList.contains("checked")&&1==r.length)return;o.classList.contains("multiple")?o.classList.toggle("checked"):(Array.from(i.parentElement.querySelectorAll(".ladi-form-checkout-payment-check.checked, .ladi-form-checkout-product-check.checked")).forEach(function(e){e.classList.remove("checked")}),o.classList.add("checked"))}c(n),L(n,t)}},s=function(t){"payment"==e.findAncestor(t.target,"ladi-element").getAttribute("data-form-checkout-item")&&e.eventFormCheckoutSelectPaymentType(t)},u=function(t){if(t.stopPropagation(),"bump_offer"==e.findAncestor(t.target,"ladi-element").getAttribute("data-form-checkout-item")){var n=e.findAncestor(t.target,"ladi-form"),a=n.querySelectorAll('[data-form-checkout-item="product"]');let d=n.querySelectorAll('[data-form-checkout-item="product"] div[data-product]');if(a.length>0){var i,o,r=n.querySelectorAll('[data-form-checkout-item="product"] .ladi-form-checkout-product-check.checked, [data-form-checkout-item="product"] [data-product] .ladi-form-checkout-payment-item > span.checked');if(1==d.length)(o=(i=e.findAncestor(t.target,"ladi-form-checkout-bump-offer-checkbox")).querySelector(".ladi-form-checkout-bump-offer-check"))&&(o.classList.contains("multiple")?o.classList.toggle("checked"):(Array.from(i.parentElement.querySelectorAll(".ladi-form-checkout-bump-offer-check.checked")).forEach(function(e){e.classList.remove("checked")}),o.classList.add("checked"))),c(t);else if(r.length>0)(o=(i=e.findAncestor(t.target,"ladi-form-checkout-bump-offer-checkbox")).querySelector(".ladi-form-checkout-bump-offer-check"))&&(o.classList.contains("multiple")?o.classList.toggle("checked"):(Array.from(i.parentElement.querySelectorAll(".ladi-form-checkout-bump-offer-check.checked")).forEach(function(e){e.classList.remove("checked")}),o.classList.add("checked"))),c(t);else LadiPageScript.showMessage(e.const.LANG.MESSAGE_WARNING_SELECT_PRODUCT_BUMP_OFFER)}}},l=function(t,n,a,i,o,r,c,d=""){isEmptyLadiPage(n)||window.ladi(t+"_cart_price").set_data(e.formatCurrency(n,e.runtime.currency,!0)),isEmptyLadiPage(d)||window.ladi(t+"_cart_promotion_discount").set_data(d),isEmptyLadiPage(a)||window.ladi(t+"_cart_discount").set_data("-"+e.formatCurrency(a,e.runtime.currency,!0)),isEmptyLadiPage(i)||window.ladi(t+"_cart_coupon_discount").set_data("-"+e.formatCurrency(i,e.runtime.currency,!0)),isEmptyLadiPage(o)||window.ladi(t+"_cart_checkout_price").set_data(e.formatCurrency(o,e.runtime.currency,!0)),isEmptyLadiPage(r)||window.ladi(t+"_cart_fee_shipping").set_data(e.formatCurrency(r,e.runtime.currency,!0)),isEmptyLadiPage(c)||window.ladi(t+"_cart_fee_shipping_discount").set_data("-"+e.formatCurrency(c,e.runtime.currency,!0))},p=function(t,n){isObjectLadiPage(e.runtime.tmp.timeout_form_checkout_get_price)||(e.runtime.tmp.timeout_form_checkout_get_price={}),e.removeTimeout(e.runtime.tmp.timeout_form_checkout_get_price),e.runtime.tmp.timeout_form_checkout_get_price[t]=e.runTimeout(function(){try{const o=document.querySelector("#"+t+' [data-form-checkout-item="total_price"]');if("none"!=window.getComputedStyle(o).display&&n.variants.length>0){var a=window.ladi("_cart_token").get_cookie(),i={"Content-Type":"application/json"};isEmptyLadiPage(a)||(i["cart-token"]=a),e.sendRequest("POST",e.const.API_LADISALE_PROMOTION,JSON.stringify(n),!0,i,function(n,a,i){if(i.readyState==XMLHttpRequest.DONE)try{var r=JSON.parse(n);if(200==a&&200==r.code&&isObjectLadiPage(r.data)&&isArrayLadiPage(r.data.variants)){e.runtime.tmp[t+"_data_cart_promotions"]=r.data.variants;let n=e.runtime.tmp[t+"_data_discount_coupon_selected"];return n&&isObjectLadiPage(n)?void m(t,n.discount_code):void g(t)}200==a&&201==a||e.showMessage(r.message)}catch(r){l(o.id,null,0,0,null,0,0)}})}else l(o.id,null,0,0,null,0,0)}catch(e){console.error(e)}},500)},m=function(n,a,i){try{let c=window.ladi("_cart_token").get_cookie(),d={"Content-Type":"application/json"};isEmptyLadiPage(c)||(d["cart-token"]=c);let s=_(n)||[],u=document.getElementById(n);u&&(u=u.querySelector("#value-coupon-code"));u&&u.textContent;var o="",r="";const l=document.getElementById(n);if(l){const e=l.querySelector('input[name="email"]'),t=l.querySelector('input[name="phone"]');e&&(o=e.value),t&&(r=t.value)}let p={domain:"",path:"",path_type:"product",discount_code:a,discount_shipping_code:i?i.code:"",shipping_state_id:t.state.split(":")[0],shipping_district_id:t.district.split(":")[0],shipping_method_id:i?i.shipping_method_id:"",variants:s,customer_email:o,customer_phone:r};e.sendRequest("POST",e.const.API_LADISALE_VALIDATE_COUPON_CODE,JSON.stringify(p),!0,d,function(t,a,i){if(i.readyState==XMLHttpRequest.DONE)try{var o=JSON.parse(t);if(200==a){if(200==o.code){let t=document.getElementById(n),a=null,i=null,r=null,c=null;if(t&&(a=t.querySelector(".checkout-block-discount-coupon"),i=t.querySelector("#value-coupon-code"),r=t.querySelector("#shipping-coupon"),c=t.querySelector("#value-coupon-shipping-code")),isObjectLadiPage(o.data)){if(a&&a.setAttribute("data-coupon-code",o.data.discount_code),a&&isObjectLadiPage(o.data.discount_shipping)&&a.setAttribute("data-coupon-shipping-code",o.data.discount_shipping.code),i){i.textContent="-"+e.formatCurrency(o.data.discount_price,e.runtime.currency,!0);let t=document.createElement("button");t.textContent="✖",t.style.marginLeft="8px",t.style.border="none",t.style.background="transparent",t.style.cursor="pointer",t.style.color="red",t.style.fontSize="14px",t.addEventListener("click",function(){i.textContent="Nhập mã giảm giá",i.removeAttribute("style"),a&&a.removeAttribute("data-coupon-code"),e.runtime.tmp[n+"_data_discount_coupon_selected"]=null,g(n)}),i.appendChild(t)}i&&0!=o.data.discount_price?(i.style.border="1px solid #EF9300",i.style.borderRadius="2px",i.style.color="EF9300",i.style.padding="2px 4px"):(i.textContent="",i.style.border="",i.style.borderRadius="",i.style.padding=""),c&&r&&isObjectLadiPage(o.data.discount_shipping)&&0!=o.data.discount_shipping.fee?(c.textContent="-"+e.formatCurrency(o.data.discount_shipping.fee,e.runtime.currency,!0),c.style.color="#4AC000",r.style.display="flex",r.style.alignItems="center",r.style.gap="4px",r.style.border="1px solid #4AC000",r.style.borderRadius="2px",r.style.padding="2px 4px"):(r.style.display="none",r.style.border="",r.style.borderRadius="",r.style.padding="")}e.runtime.tmp[n+"_data_discount_coupon_selected"]=o.data,e.runtime.tmp[n+"_data_discount_shipping_selected"]=isObjectLadiPage(o.data.discount_shipping)&&o.data.discount_shipping,g(n);let d=document.querySelectorAll(".ladipage-message-close");return void(d&&(d.forEach(function(e){e.click()}),document.body.style.overflow=""))}e.showMessage(o.message)}200==a&&201==a||e.showMessage(o.message)}catch(o){}})}catch(e){console.log("err validateCouponCode",e)}},_=function(t){let n=[],a=document.querySelectorAll("#"+t+' [data-form-checkout-item="product"] div[data-product]'),i=document.querySelectorAll("#"+t+' [data-form-checkout-item="bump_offer"] .ladi-form-checkout-bump-offer-check.checked'),o=document.querySelectorAll("#"+t+" .ladi-form-checkout-product-check.checked, #"+t+' [data-form-checkout-item="product"] [data-product] .ladi-form-checkout-payment-item > span.checked'),r=document.querySelectorAll("#"+t+" .ladi-form-checkout-bump-offer-check.checked");const c=Array.from(o).concat(Array.from(r));if(1===a.length){const t=a[0].closest(".ladi-form-checkout-box"),o=t.querySelector('.ladi-form-checkout-payment-quantity input[type="number"]');if(t){const a=e.parseFormCheckoutProduct(t),i=isEmptyLadiPage(o)?1:parseInt(o.value);n.push({product_name:a.name,price:a.price,product_variant_id:a.product_variant_id,product_id:a.product_id,quantity:i,store_id_product:isObjectLadiPage(a)?a.store_id_product:null})}i.forEach(t=>{const a=t.closest(".ladi-form-checkout-bump-offer-product"),i=e.parseFormCheckoutProduct(a);n.push({product_name:i.name,price:i.price,product_id:i.product_id,product_variant_id:i.product_variant_id,quantity:1})})}else c.forEach(t=>{const a=t.closest(".ladi-form-checkout-box, .ladi-form-checkout-bump-offer-product"),i=isEmptyLadiPage(a)?null:a.querySelector('.ladi-form-checkout-payment-quantity input[type="number"]');if(a){const t=e.parseFormCheckoutProduct(a),o=isEmptyLadiPage(i)?1:parseInt(i.value);n.push({product_name:isObjectLadiPage(t)?t.name:"",price:isObjectLadiPage(t)?t.price:"",product_id:isObjectLadiPage(t)?t.product_id:null,product_variant_id:isObjectLadiPage(t)?t.product_variant_id:null,quantity:o,store_id_product:isObjectLadiPage(t)?t.store_id_product:null})}});return n},g=function(t){let n=e.runtime.tmp[t+"_data_discount_coupon_selected"]||null,a=e.runtime.tmp[t+"_data_discount_shipping_selected"]||null,i=e.runtime.tmp[t+"_data_cart_promotions"]||null,o=0,r=0,c=0,d=0,s=0,u=0,p="";try{const e=document.querySelector("#"+t+' [data-form-checkout-item="total_price"]');if(isEmptyLadiPage(e))return;let m=_(t)||[];if("none"!=window.getComputedStyle(e).display&&m.length>0){if(m.forEach(e=>{o+=e.price*e.quantity}),n&&n.discount_price?(d=o-n.discount_price,c=n.discount_price):d=o,i&&i.length>0){if(n&&0==n.allow_promotion)r=0;else{r=i.reduce((e,t)=>{if(t.discount){const{type:n,value:a}=t.discount;return 1==n?e+t.price*(a/100)*t.quantity:e+a*t.quantity}return e},0);p=i.filter(e=>e.discount&&e.discount.note).map(e=>e.discount.note).join(", "),d-=r,d<0&&(d=0)}d=o-r-c}const _=document.querySelector("#"+t+' [data-form-checkout-item="fee_shipping"]');if(!isEmptyLadiPage(_)){const e=document.querySelector(".ladi-form-checkout-method-shipping-check.checked");if(!isEmptyLadiPage(e)){const t=e.closest(".ladi-form-checkout-box").getAttribute("data-shipping-method");if(!isEmptyLadiPage(t)){const e=JSON.parse(Base64.decode(t));isEmptyLadiPage(e)||(s=e.value,d+=e.value)}}}a&&(u=a.fee,d-=a.fee),d<0&&(d=0),l(e.id,o,r,c,d,s,u,p)}}catch(e){console.log("err.........",e)}},f=function(t){t.stopPropagation();var n=e.findAncestor(t.target,["ladi-form","ladi-element"]),a=e.findAncestor(t.target,"ladi-element"),i=n.id;if("fee_shipping"==a.getAttribute("data-form-checkout-item")){var o=e.findAncestor(t.target,"ladi-form-checkout-box"),r=o.querySelector(".ladi-form-checkout-payment-check, .ladi-form-checkout-method-shipping-check");if(r){var c=a.querySelectorAll(".ladi-form-item [data-shipping-method]");if(r.classList.contains("checked")&&1==c.length)return;r.classList.contains("multiple")?r.classList.toggle("checked"):(Array.from(o.parentElement.querySelectorAll(".ladi-form-checkout-payment-check.checked, .ladi-form-checkout-method-shipping-check.checked")).forEach(function(e){e.classList.remove("checked")}),r.classList.add("checked"))}const n=document.querySelector("#"+i+' [data-form-checkout-item="fee_shipping"]');if(!isEmptyLadiPage(n)){const t=document.querySelector("#"+i+" .ladi-form-checkout-method-shipping-check.checked");if(!isEmptyLadiPage(t)){const n=t.closest(".ladi-form-checkout-box").getAttribute("data-shipping-method");if(!isEmptyLadiPage(n)){const t=JSON.parse(Base64.decode(n));isEmptyLadiPage(t)||(e.runtime.tmp[i+"_data_method_shipping_selected"]=t)}}}g(i)}},h=function(t){var n=window.ladi("_cart_token").get_cookie(),a={"Content-Type":"application/json"};isEmptyLadiPage(n)||(a["cart-token"]=n);let i={ladi_uid:e.runtime.store_ladiuid,show_all:!0,lang:"vi",is_ladipage:!0};e.sendRequest("POST",e.const.API_LADISALE_LIST_GATEWAY,JSON.stringify(i),!0,a,function(e,n,a){if(a.readyState==XMLHttpRequest.DONE)try{var i=JSON.parse(e);if(200==n)if(200!=i.code||isEmptyLadiPage(i.data))console.log("Response error: ",i.message);else{i.data.filter(e=>0==e.status).map(e=>e.code).forEach(e=>{const t=document.querySelector(`[data-payment-code="${e}"]`);t&&t.remove()});const e=document.querySelectorAll("#"+t+' [data-form-checkout-item="payment"] .ladi-form-checkout-box');if(1==e.length){e[0].style.borderBottom="none";const t=e[0].querySelector(".ladi-form-checkout-payment-check");t&&t.remove()}U()}}catch(i){console.log("err list gateway by ldp",i)}})},y=!0,v=function(t=null){const n=document.createElement("div");if(n.classList.add("ladi-form-checkout-box"),t){const e=JSON.stringify({shipping_method_name:t.name,shipping_method_id:t.shipping_method_id,value:t.fee});n.setAttribute("data-shipping-method",Base64.encode(e))}const a=document.createElement("div");a.classList.add("ladi-form-checkout-payment-item");const i=document.createElement("span");i.classList.add("ladi-form-checkout-payment-check","ladi-form-checkout-method-shipping-check"),i.style.cursor="pointer";const o=document.createElement("div");o.classList.add("ladi-form-checkout-payment-content","ladi-form-checkout-shipping-content"),o.style.justifyContent="space-between",o.style.flex="1 1 0%",o.style.cursor="pointer";const r=document.createElement("span");r.textContent=t?t.name:"";const c=document.createElement("span");return c.textContent=t?e.formatCurrency(t.fee,e.runtime.currency,!0):"",o.appendChild(r),o.appendChild(c),a.appendChild(i),a.appendChild(o),n.appendChild(a),n.addEventListener("click",f),n},E=function(t){const n=document.querySelector("#"+t+' [data-form-checkout-item="fee_shipping"]');if(!isEmptyLadiPage(n)){const n=document.querySelector("#"+t+" .ladi-form-checkout-method-shipping-check.checked");if(!isEmptyLadiPage(n)){const a=n.closest(".ladi-form-checkout-box").getAttribute("data-shipping-method");if(!isEmptyLadiPage(a)){const n=JSON.parse(Base64.decode(a));isEmptyLadiPage(n)||(e.runtime.tmp[t+"_data_method_shipping_selected"]=n)}}}},k=function(t){const n=document.querySelector("#"+t+' [data-form-checkout-item="fee_shipping"]');isEmptyLadiPage(n)||(n.style.height="30px");const a=document.querySelector("#"+t+' [data-form-checkout-item="fee_shipping"] .ladi-form-item');a&&(a.innerHTML="");const i=[];i.forEach(function(){const e=v();a.appendChild(e)});var o=e.findAncestor(a,"ladi-element");o&&(0==i.length?o.style.setProperty("display","none","important"):o.style.removeProperty("display")),g(t)},L=function(t,n){var a=e.findAncestor(t.target,["ladi-form","ladi-element"]).id;let i=_(a)||[],o={store_id:null!=(i[0]&&i[0].store_id_product)?i[0].store_id_product:e.runtime.store_id_int,state_id:n.state.split(":")[0],district_id:n.district.split(":")[0],discount_code:"",lang:"vi",variants:i};var r=window.ladi("_cart_token").get_cookie(),c={"Content-Type":"application/json"};isEmptyLadiPage(r)||(c["cart-token"]=r);const d=document.querySelector("#"+a+' [data-form-checkout-item="fee_shipping"]');isEmptyLadiPage(n.state)||isEmptyLadiPage(n.state)||!d||e.sendRequest("POST",e.const.API_LADISALE_GET_SHIPPING_METHODS,JSON.stringify(o),!0,c,function(t,n,i){if(i.readyState==XMLHttpRequest.DONE)try{var o=JSON.parse(t);200==n&&(200==o.code&&isObjectLadiPage(o.data)?(y=!1,function(t,n){const a=document.querySelector("#"+n+' [data-form-checkout-item="fee_shipping"]');isEmptyLadiPage(a)||(a.style.height=48*t.length+28+"px");const i=document.querySelector("#"+n+' [data-form-checkout-item="fee_shipping"] .ladi-form-item');i&&(i.innerHTML=""),t.forEach(function(e,t){const n=v(e);if(0==t){let e=n.querySelector(".ladi-form-checkout-payment-item .ladi-form-checkout-method-shipping-check");e&&e.classList.add("checked")}i.appendChild(n)});var o=e.findAncestor(i,"ladi-element");0==t.length?o.style.setProperty("display","none","important"):o.style.removeProperty("display"),g(n),E(n)}(o.data.shipping_methods,a)):y||k(a))}catch(o){console.log("err response.........",o)}})},P=async function(n){let a=e.runtime.store_id_int,i=window.ladi("_cart_token").get_cookie(),o={"Content-Type":"application/json"};isEmptyLadiPage(i)||(o["cart-token"]=i);let r={store_id:e.runtime.store_id_int_counpon||a},c=[],d=[];var s=e.findAncestor(n.target,["ladi-form","ladi-element"]);if(!s)return;var u=s.id;document.getElementById(u);var l=function(t){return 1==t.type?e.formatCurrency(t.value,"%",!0):e.formatCurrency(t.value,e.runtime.currency,!0)},p=function(e,t){return e.map(e=>{let n="shipping"===t?"data-coupon-shipping-code":"data-coupon-code",a="";return a="shipping"===t?`<p>${LadiPageScript.const.LANG.DISCOUNT_VALUE_SHIPPING_FEE.format(l(e))}</p>`:e.apply_to[1]?`<p>${LadiPageScript.const.LANG.DISCOUNT_TYPE_ORDER_PRODUCT_IN_CART.format(l(e))}</p>`:e.apply_to[2]?`<p>${LadiPageScript.const.LANG.DISCOUNT_TYPE_TAG_PRODUCT_IN_CART.format(l(e))}</p>`:`<p>${LadiPageScript.const.LANG.DISCOUNT_TYPE_PRODUCT_IN_CART.format(l(e))}</p>`,`\n                    <div class="coupon-item" ${n}="${e.code}">\n                        <div class="title-desc">\n                            <h3>${e.code}</h3>\n                            ${a}\n                        </div>\n                        <div class="action">\n                            <div class="radio-custom"></div>\n                        </div>\n                    </div>\n                `}).join("")};e.sendRequest("POST",e.const.API_LADISALE_LIST_COUPON_CODE,JSON.stringify(r),!0,o,function(a,i,o){try{if(o.readyState==XMLHttpRequest.DONE&&200==i){var r=JSON.parse(a);if(200==r.code&&isObjectLadiPage(r.data)){c=r.data.discounts||[],d=r.data.discountsShipping||[],LadiPageScript.showMessage(`\n            <style>\n                /*.ladipage-message .ladipage-message-box {*/\n                /*    width: 460px !important;*/\n                /*    height: max-content !important;*/\n                /*}*/\n                .ladipage-message-box {\n                    font-family: "Roboto", sans-serif;\n                    border-radius: 0 !important;\n                    width: 100% !important;\n                    max-width: 100% !important;\n                    height: 100% !important;\n                    top: 0 !important;\n                    left: 0 !important;\n                    background: transparent !important;\n                    display: flex !important;\n                    justify-content: center;\n                    align-items: center;\n                }\n                /*.ladipage-message .ladipage-message-box .ladipage-message-text {*/\n                /*    margin: 0 !important;*/\n                /*    padding: 0 !important;*/\n                /*}*/\n                .ladipage-message-text {\n                    display: block !important;\n                    width: fit-content;\n                    height: fit-content;\n                    margin-top: 0 !important;\n                    padding: 24px !important;\n                    background: #fff;\n                    border-radius: 8px;\n                    position: relative;\n                }\n                .ladipage-message .ladipage-message-box>span {\n                    display: none;\n                }\n                .ladipage-message .ladipage-message-box .top-header-modal-coupon-code {\n                    padding-bottom: 20px;\n                    display: flex;\n                    border-bottom: 1px solid #E7E9EB;\n                    align-items: center;\n                    justify-content: space-between;\n                }\n                .ladipage-message .ladipage-message-box .top-header-modal-coupon-code h3 {\n                    font-weight: bold;\n                    font-size: 18px;\n                    line-height: 24px;\n                    color: #0E233C;\n                }\n                .ladipage-message .ladipage-message-box .top-header-modal-coupon-code .close-icon {\n                    display: flex;\n                    align-items: center;\n                }\n                .ladipage-message .ladipage-message-box .top-header-modal-coupon-code .close-icon .ldicon-circle-close-fill {\n                    width: 18px;\n                    height: 18px;\n                    cursor: pointer;\n                    mask-image: url(https://w.ladicdn.com/ladiui/icons/new-ldicon-close-fill-2.svg);\n                    mask-size: cover;\n                    mask-repeat: no-repeat;\n                    display: inline-block;\n                    background-color: #566577;\n                }\n                .ladipage-message .ladipage-message-box .content-modal-coupon-code {\n                    padding: 20px 0;\n                }\n                .ladipage-message .ladipage-message-box .content-modal-coupon-code .block-input-enter-coupon-code {\n                    margin-bottom: 16px;\n                    display: flex;\n                    align-items: center;\n                    justify-content: space-between;\n                    gap: 16px;\n                }\n                .ladipage-message .ladipage-message-box .content-modal-coupon-code .block-input-enter-coupon-code input {\n                    padding: 10px 12px;\n                    border: 1px solid #CFD3D8;\n                    border-radius: 4px;\n                    width: 80%;\n                }\n                .ladipage-message .ladipage-message-box .content-modal-coupon-code .block-input-enter-coupon-code button {\n                    padding: 10px 22px;\n                    border-radius: 4px;\n                    border: 1px solid #1C00C2;\n                    color: #1C00C2;\n                    background-color: transparent;\n                    white-space: nowrap;\n                    cursor: pointer;\n                }\n                .content-modal-coupon-code .list-coupons {\n                    display: flex;\n                    flex-direction: column;\n                    gap: 16px;\n                    max-height: 400px;\n                    overflow-y: auto;\n                }\n                .content-modal-coupon-code .list-coupons .coupon-item {\n                    display: flex;\n                    align-items: center;\n                    justify-content: space-between;\n                    padding: 8px 16px;\n                    border-radius: 4px;\n                    border: 1px solid #CFD3D8;\n                    min-width: 340px;\n                    cursor: pointer;\n                }\n                .content-modal-coupon-code .list-coupons .order-coupon-code {\n                    display: flex;\n                    flex-direction: column;\n                    gap: 16px;\n                }\n                .content-modal-coupon-code .list-coupons .shipping-code {\n                    display: flex;\n                    flex-direction: column;\n                    gap: 16px;\n                }\n                .content-modal-coupon-code .list-coupons .coupon-item .title-desc h3 {\n                    font-weight: 500;\n                    font-size: 14px;\n                    line-height: 16px;\n                    margin-bottom: 4px;\n                    color: #1C00C2;\n                }\n                .content-modal-coupon-code .list-coupons .title-group-common {\n                    display: flex;\n                    align-items: center;\n                    color: #0E233C;\n                    font-size: 16px;\n                }\n                .content-modal-coupon-code .list-coupons .title-group-common p {\n                    color: #9FA7B1;\n                    font-size: 14px;\n                    margin-left: 2px;\n                }\n                .content-modal-coupon-code .list-coupons .coupon-item .title-desc p {\n                    font-weight: 400;\n                    font-size: 12px;\n                    line-height: 16px;\n                    color: #566577;\n                }\n                .content-modal-coupon-code .list-coupons .coupon-item .action .radio-custom {\n                    border-size: 1px;\n                    width: 18px;\n                    height: 18px;\n                    border: 1px solid #CFD3D8;\n                    border-radius: 100%;\n                    display: block;\n                    position: relative;\n                }\n                .content-modal-coupon-code .list-coupons .coupon-item.checked .action .radio-custom {\n                    border: 1px solid #1C00C2 !important;\n                }\n                .content-modal-coupon-code .list-coupons .coupon-item.checked .action .radio-custom::before {\n                    content: "";\n                    width: 9px;\n                    height: 9px;\n                    border-radius: inherit;\n                    display: block;\n                    position: absolute;\n                    top: 0;\n                    left: 0;\n                    background-color: #1C00C2;\n                    transform: translate(40%, 40%);\n                }\n                \n                .ladipage-message-close {\n                    display: none !important;\n                }\n                \n                .ladipage-message .ladipage-message-box .footer-modal-coupon-code {\n                    display: flex;\n                    justify-content: end;\n                    padding-top: 20px;\n                    border-top: 1px solid #E7E9EB;\n                }\n                \n                .ladipage-message .ladipage-message-box .footer-modal-coupon-code .group-btn {\n                    display: flex;\n                    align-items: center;\n                    gap: 16px;\n                }\n                \n                .ladipage-message .ladipage-message-box .footer-modal-coupon-code .group-btn button {\n                    padding: 10px 16px;\n                    border-radius: 4px;\n                    font-weight: 400;\n                    font-size: 14px;\n                    line-height: 20px;\n                    cursor: pointer;\n                }\n                \n                .ladipage-message .ladipage-message-box .footer-modal-coupon-code .group-btn .cancel {\n                    background-color: #F3F4F5;\n                    color: #0E233C;\n                }\n                .ladipage-message .ladipage-message-box .footer-modal-coupon-code .group-btn .confirm {\n                    background-color: #1C00C2;\n                    color: #fff;\n                }\n                #input-enter-coupon-code {\n                    text-transform: uppercase;\n                }\n                \n                @media only screen and (max-width: 768px) {\n                    .ladipage-message {\n                        height: auto;\n                        position: absolute;\n                    }\n                    .ladipage-message-text {\n                        /*margin: auto;*/\n                        /*overflow-y: scroll !important;*/\n                        /*max-height: 100vh;*/\n                        /*min-width: 100%;*/\n                        margin: auto;\n                        overflow-y: hidden !important;\n                        max-height: 100vh;\n                        min-width: 100%;\n                        height: 100vh;\n                        position: fixed;\n                        top: 0;\n                        left: 0;\n                    }\n\n                    .ladipage-message .ladipage-message-box {\n                        position: absolute !important;\n                        border: none;\n                    }\n                    .ladipage-message-text .ladipage-message-content {\n                        flex-direction: column-reverse;\n                        justify-content: center;\n                        align-items: center;\n                    }\n                }\n                \n            </style>\n            <div class="top-header-modal-coupon-code">\n                <h3>${LadiPageScript.const.LANG.APPLY_COUPON_DISCOUNT}</h3>\n                <div class="close-icon" id="action-close-modal-coupon-code">\n                    <i class="ldicon-circle-close-fill"></i>\n                </div>\n            </div>\n            <div class="content-modal-coupon-code">\n                <div class="block-input-enter-coupon-code">\n                    <input class="ladi-form-control" type="text" id="input-enter-coupon-code" placeholder="${LadiPageScript.const.LANG.ENTER_DISCOUNT_CODE}" />\n                    <button type="button" class="ladiui btn btn-outline-primary" id="button-apply-coupon-code-input">${LadiPageScript.const.LANG.APPLY_COUPON_DISCOUNT}</button>\n                </div>\n                <div style="${l=e.findAncestor(n.target,"ladi-element"),isEmptyLadiPage(l)||"false"!=l.getAttribute("data-list-coupon-code")?"":"opacity: 0; height: 0; pointer-events: none; margin-top: -16px;"}" class="list-coupons">\n                    ${function(){let e=null;const n=document.querySelector("#"+u+' [data-form-checkout-item="fee_shipping"]');if(!isEmptyLadiPage(n)){const t=document.querySelector(".ladi-form-checkout-method-shipping-check.checked");if(!isEmptyLadiPage(t)){const n=t.closest(".ladi-form-checkout-box").getAttribute("data-shipping-method");isEmptyLadiPage(n)||(e=JSON.parse(Base64.decode(n)))}}return!(isEmptyLadiPage(t.state)||isEmptyLadiPage(t.district)||isEmptyLadiPage(e))}()?`\n                        <div class="shipping-code">\n                            <div class="title-group-common">\n                                ${LadiPageScript.const.LANG.SHIPPING_DISCOUNT_FEE} <p> ${LadiPageScript.const.LANG.YOU_CAN_CHOOSE_ONLY_ONE_DISCOUNT_CODE}</p>\n                            </div>\n                            ${p(d,"shipping")}\n                        </div>\n                        `:""}\n                    <div class="order-coupon-code">\n                        <div class="title-group-common">${LadiPageScript.const.LANG.COUPON_DISCOUNT_CODE} <p> ${LadiPageScript.const.LANG.YOU_CAN_CHOOSE_ONLY_ONE_DISCOUNT_CODE}</p></div>\n                        ${p(c,"regular")}\n                    </div>\n                </div>\n            </div>\n            <div class="footer-modal-coupon-code">\n                <div class="group-btn">\n                    <button class="cancel" id="btn-cancel-coupon-code" type="button">${LadiPageScript.const.LANG.CANCEL}</button>\n                    <button class="confirm" type="button" id="btn-confirm-coupon-code-form-checkout">${LadiPageScript.const.LANG.CONFIRM}</button>\n                </div>\n            </div>\n        `),document.body.style.overflow="hidden";let a=document.getElementById("action-close-modal-coupon-code");a&&a.addEventListener("click",function(){let e=document.querySelectorAll(".ladipage-message-close");e&&(e.forEach(function(e){e.click()}),document.body.style.overflow="")});let i=s.querySelector(".checkout-block-discount-coupon");const o=document.querySelectorAll(".coupon-item[data-coupon-shipping-code]");let g=i?i.getAttribute("data-coupon-shipping-code"):null;o.forEach(function(e){g&&o.forEach(function(e){let t=e.getAttribute("data-coupon-shipping-code");t&&t==g&&e.classList.add("checked")}),e.addEventListener("click",function(){o.forEach(function(e){e.classList.remove("checked")}),this.classList.add("checked")})});const f=document.querySelectorAll(".coupon-item[data-coupon-code]");let h=i?i.getAttribute("data-coupon-code"):null;f.forEach(function(e){h&&f.forEach(function(e){let t=e.getAttribute("data-coupon-code");t&&t==h&&e.classList.add("checked")}),e.addEventListener("click",function(e){f.forEach(function(e){e.classList.remove("checked")}),this.classList.add("checked")})});const y=document.getElementById("btn-cancel-coupon-code");y&&y.addEventListener("click",function(){let e=document.querySelectorAll(".ladipage-message-close");e&&(e.forEach(function(e){e.click()}),document.body.style.overflow="")});_(u);const v=document.getElementById("btn-confirm-coupon-code-form-checkout");v&&v.addEventListener("click",function(){let e=null,t="",n=document.querySelector(".order-coupon-code .coupon-item.checked"),a=document.querySelector(".shipping-code .coupon-item.checked");if(n&&(t=n.getAttribute("data-coupon-code")),a){const t=a.getAttribute("data-coupon-shipping-code"),n=document.querySelector("#"+u+' [data-form-checkout-item="fee_shipping"]');if(!isEmptyLadiPage(n)){const n=document.querySelector(".ladi-form-checkout-method-shipping-check.checked");if(!isEmptyLadiPage(n)){const a=n.closest(".ladi-form-checkout-box").getAttribute("data-shipping-method");if(!isEmptyLadiPage(a)){e={code:t,shipping_method_id:JSON.parse(Base64.decode(a)).shipping_method_id}}}}}m(u,t,e)});const E=document.getElementById("button-apply-coupon-code-input");E&&E.addEventListener("click",e=>{let t=document.getElementById("input-enter-coupon-code").value,n=null,a=document.querySelector(".shipping-code .coupon-item.checked");if(a){const e=a.getAttribute("data-coupon-shipping-code"),t=document.querySelector("#"+u+' [data-form-checkout-item="fee_shipping"]');if(!isEmptyLadiPage(t)){const t=document.querySelector(".ladi-form-checkout-method-shipping-check.checked");if(!isEmptyLadiPage(t)){const a=t.closest(".ladi-form-checkout-box").getAttribute("data-shipping-method");if(!isEmptyLadiPage(a)){n={code:e,shipping_method_id:JSON.parse(Base64.decode(a)).shipping_method_id}}}}}m(u,t,n)})}}throw new TypeError("error")}catch(e){}var l})};Array.from(document.querySelectorAll("#action-show-popup-coupon-code")).forEach(function(e){e.addEventListener("click",P)});const b=window.location.search,A=new URLSearchParams(b).get("discount_code");if(A){let t=e.runtime.store_id_int,n=document.querySelectorAll(".ladi-form"),a=[];n&&n.length>0&&n.forEach(function(e){let t=e.closest("[id]");t&&t.id&&a.push(t.id)});let i=window.ladi("_cart_token").get_cookie(),o={"Content-Type":"application/json"};isEmptyLadiPage(i)||(o["cart-token"]=i);let r={store_id:t};e.sendRequest("POST",e.const.API_LADISALE_LIST_COUPON_CODE,JSON.stringify(r),!0,o,function(e,t,n){try{if(n.readyState==XMLHttpRequest.DONE&&200==t){var i=JSON.parse(e);if(200==i.code&&isObjectLadiPage(i.data)){let e=(i.data.discounts||[]).find(e=>e.code==A);e&&a&&a.length>0&&a.forEach(t=>{m(t,e.code)})}}}catch(e){console.log("Error api coupon")}})}for(var w=function(e){const t=document.querySelector("#"+e+" .overlay-checkout");t&&t.remove()},O=document.getElementsByClassName("ladi-form"),S=0;S<O.length;S++){var T=e.findAncestor(O[S],["ladi-element"]).id;k(T),w(T);for(var x=O[S].querySelectorAll(".ladi-form-checkout-payment-quantity"),N=0;N<x.length;N++){var C=x[N].querySelectorAll("span")[0],q=x[N].querySelectorAll("span")[1];isEmptyLadiPage(C)||C.addEventListener("click",o),isEmptyLadiPage(q)||q.addEventListener("click",r)}var R=O[S].querySelectorAll(".ladi-form-checkout-payment-quantity input");for(N=0;N<R.length;N++)R[N].addEventListener("change",i),i({target:R[N]});var D=O[S].querySelectorAll('[data-form-checkout-item="payment"]');for(N=0;N<D.length;N++)h(T);var F=O[S].querySelectorAll(".ladi-element.address-info-checkout"),I=[];if(F){F.forEach(function(e){var t=e.querySelectorAll("select, input");I.push(...t)});for(let e=0;e<I.length;e++)if("SELECT"===I[e].tagName){const n=I[e];n.addEventListener("change",function(e){const a=n.getAttribute("name"),i=n.value;"state"===a?(t.state=i,t.district="",t.ward=""):"district"===a?t.district=i:"ward"===a&&(t.ward=i),L(e,t)})}}var M=O[S].querySelectorAll(".ladi-form-checkout-payment-check, .ladi-form-checkout-payment-content, .ladi-form-checkout-product-content, .ladi-form-checkout-bump-offer-checkbox");O[S].querySelectorAll(".ladi-form-checkout-product-content");for(N=0;N<M.length;N++)M[N].style.setProperty("cursor","pointer"),M[N].addEventListener("click",d),M[N].addEventListener("click",s),M[N].addEventListener("click",u)}var j=function(t){try{if(t.clientWidth<=0&&t.clientHeight<=0)return void e.runTimeout(function(){j(t)},500);if(t.querySelectorAll('[data-form-checkout-item="product"]').length>0)if(0==t.querySelectorAll('[data-form-checkout-item="product"] .ladi-form-checkout-payment-check.checked, [data-form-checkout-item="product"] .ladi-form-checkout-product-check.checked').length){var n=t.querySelector('[data-form-checkout-item="product"] .ladi-form-checkout-payment-check');n&&n.click()}}catch(e){}};for(S=0;S<O.length;S++)j(O[S]);var U=function(){var t=function(n){isEmptyLadiPage(n.getAttribute("data-payment"))?e.runTimeout(function(){t(n)},100):U()};for(S=0;S<O.length;S++){var n=e.findAncestor(O[S],"ladi-element");if(isEmptyLadiPage(n.getAttribute("data-payment")))try{if(1===n.querySelectorAll('[data-form-checkout-item="payment"] div[data-payment-code]').length){var a=n.querySelector('[data-form-checkout-item="payment"] .ladi-form-checkout-payment-content');if(a){isObjectLadiPage(LadiPageScript.runtime.tmp.isObjectCheck)||(LadiPageScript.runtime.tmp.isObjectCheck={}),LadiPageScript.runtime.tmp.isObjectCheck[n.id]=!0,a.click(),t(n);break}}}catch(e){}}};U()},LadiPageScriptV2.prototype.runFocusInput=function(e){var t=this;if(t instanceof LadiPageScriptV2||(t=LadiPageScript),t.runtime.tmp.timeout_form_submit_id)try{t.runTimeout(function(){e.target.scrollIntoView({behavior:"smooth",block:"center"})},0)}catch(e){}},LadiPageScriptV2.prototype.runOptionForm=function(e,t,n){var a,i=this,o=window.ladi("LADI_CAMP_TARGET_URL").get_cookie(),r=window.ladi("LADI_CAMP_CONFIG").get_cookie(),c=document.getElementsByClassName("ladi-form"),d=0,s=null,u=null,l=null,p=null,m=null,_=null,g=null,f=null,h=null,y=null,v=null,E=null,k=null,L=null,P=null,b=null,A=null,w=null,O=null,S=i.runtime.shopping,T=null,x=["utm_source","utm_medium","utm_campaign","utm_term","utm_content"],N=["name","email","phone","address","ward","district","state","country"],C=["email","phone"],q=i.copy(i.runtime.list_set_value_name_country).reverse(),R=function(e,t){var n="_capture_"+e,a=window.ladi(n).get_cookie(),o=!1,r=i.runtime.tmp["cookie_cache_otp_"+e];if(isEmptyLadiPage(a)&&isObjectLadiPage(r)&&!isEmptyLadiPage(r[n])&&(a=r[n],o=!0),isEmptyLadiPage(a)){a=t+"|"+i.runtime.ladipage_id+"|"+Date.now()+"|"+i.randomId();var c=new Date;c.setTime(c.getTime()+9e5),o?(r[n]=a,i.runtime.tmp["cookie_cache_otp_"+e]=r):window.ladi(n).set_cookie(a,c)}return a},D=function(e,t,n){var a=i.runtime.tmp["form_data_ladi_"+v];if(isObjectLadiPage(a))return!0;if(t&&isEmptyLadiPage(u[n]))return!1;var o=!0,r=e.getElementsByClassName("ladi-survey");for(f=0;f<r.length;f++){var c=i.findAncestor(r[f],"ladi-element");if(!isEmptyLadiPage(c)){var d=i.runtime.eventData[c.id];if(!isEmptyLadiPage(d)&&d["option.survey_setting.input_required"]&&!isEmptyLadiPage(d["option.survey_setting.input_name"])&&(!t||d["option.survey_setting.input_name"]==n)){var s=c.id,l=e.querySelector('.ladi-element.ladi-form-item-survey[data-name="'+d["option.survey_setting.input_name"]+'"]');isEmptyLadiPage(l)||(s=l.id);var p=window.ladi(s).value();if(isEmptyLadiPage(p)){o=!1;break}}}}var m=null;if(Array.from(document.querySelectorAll('.ladi-form-checkbox-box-item input[data-other="true"]:checked, .ladi-form-checkbox-box-item input[type="radio"][data-other="true"]:checked')).forEach(function(e){o&&isEmptyLadiPage(e.value)&&(o=!1,m=function(){var t=e.parentElement.getElementsByClassName("ladi-editing")[0];isEmptyLadiPage(t)||(t.focus(),i.runFocusInput({target:t}))})}),!o)return t||i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,m),!1;var _=[];if(w.forEach(function(e){isEmptyLadiPage(u[e])&&_.push(e)}),t&&(_=_.only([n])),_.length>0)return t||i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,function(){var t=e.querySelector('[name="'+_[0]+'"]');isEmptyLadiPage(t)||(t.focus(),i.runFocusInput({target:t}))}),!1;var g=!0,f=0,h=function(){var t=e.querySelector('[name="'+O[f].name+'"]');isEmptyLadiPage(t)||(t.focus(),i.runFocusInput({target:t}))};for(f=0;f<O.length;f++)if(!t||O[f].name==n){var y=u[O[f].name];if(!isEmptyLadiPage(y))try{if(!new RegExp("^"+O[f].pattern+"$",O[f].pattern_flag).test(y)){t||i.showMessage(O[f].title,null,h),g=!1;break}}catch(e){}}return function(n){var a=e.querySelectorAll(".ladi-element .ladi-form-item-container [name]"),o=[],r=500;function c(e,t){if(!isEmptyLadiPage(e))return!(e.length>t)||(g=!1)}function d(e){if(isEmptyLadiPage(e))return;const t=e.value.replace(/\s/g,"").replace(/\./g,""),n=t.length<=15,a=e.getAttribute("pattern");if(a)try{const e=new RegExp(a);return n&&e.test(t)}catch(e){console.error("Invalid regular expression:",e)}return!isNaN(t)&&n}function s(e,t){if(!isEmptyLadiPage(e)){if(t)try{const n=t.replace(/^\/|\/$/g,"");return new RegExp(n).test(e)}catch(e){console.error("Invalid regular expression:",e)}return!0}}var u=Array.from(a).find(e=>"tel"===e.type);if(n.phone&&u){if(!d(u)||!c(n.phone.replace(/\s/g,"").replace(/\./g,""),15))return t||i.showMessage(i.const.LANG.FORM_INPUT_PHONE_ERROR,null,m),g=!1;o.push("phone")}if(n.email&&!c(n.email||"",50))return o.push("email"),t||i.showMessage(i.const.LANG.FORM_INPUT_EMAIL_ERROR,null,m),g=!1;if(!t&&n.name&&!c(n.name||"",r))return o.push("name"),i.showMessage(i.const.LANG.FORM_INPUT_NAME_ERROR,{max_length:r}),g=!1;if(!t&&n.message&&!c(n.message||"",2e3))return o.push("message"),i.showMessage(i.const.LANG.FORM_INPUT_MESSAGE_ERROR,{max_length:2e3}),g=!1;const l=["ward","district","state","country"];for(let e of l){const a=n[e];if(null==a)continue;const c=a.split(":")[1];if(!isEmptyLadiPage(c)&&(!t&&c&&c.length>r)){i.showMessage(i.const.LANG.FORM_INPUT_LOCATE_ERROR,{max_length:r}),o.push(e),g=!1;break}}for(let e of a){const n=e.name,a=e.value,u=e.placeholder;if(!o.includes(n)&&n){switch(e.type){case"text":if(!t){if(e.required&&isEmptyLadiPage(a))return i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,m),g=!1;if(a.length>r){const e={field_name:u||n,max_length:r};return i.showMessage(i.const.LANG.FORM_INPUT_TYPE_TEXT_ERROR,e),g=!1}}break;case"number":if(!t){if(e.required&&isEmptyLadiPage(a))return i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,m),g=!1;if(a&&(isNaN(a)||a.length>r))return i.showMessage(i.const.LANG.FORM_INPUT_TYPE_NUMBER_ERROR,{field_name:u||n,max_length:r}),g=!1}break;case"password":if(!t){if(e.required&&isEmptyLadiPage(a))return i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,m),g=!1;if(a&&a.length>r)return i.showMessage(i.const.LANG.FORM_INPUT_TYPE_TEXT_ERROR,{field_name:u||n,max_length:r}),g=!1}break;case"email":const o=e.getAttribute("pattern");if(e.required&&isEmptyLadiPage(a))return t||i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,m),g=!1;if(a&&(!c(a,50)||!s(a,o)))return t||i.showMessage(i.const.LANG.FORM_INPUT_EMAIL_ERROR,null,m),g=!1;break;case"tel":const l=a.replace(/\s/g,"").replace(/\./g,"");if(e.required&&isEmptyLadiPage(a))return t||i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR,null,m),g=!1;if(a&&(!d(e)||!c(l,15)))return t||i.showMessage(i.const.LANG.FORM_INPUT_PHONE_ERROR,null,m),g=!1}o.push(n)}}}(u),g},F=function(e,t){u={},l={},p={},m={};for(var n=e.querySelectorAll(".ladi-element .ladi-form-item-container [name]"),a={},o=null,r=0;r<n.length;r++)o=n[r].getAttribute("name"),a[o]=parseInt(n[r].getAttribute("tabindex"))||0;var c=Object.keys(a).sort(function(e,t){return a[e]-a[t]});if(c.only(i.runtime.list_set_value_name_country).length==i.runtime.list_set_value_name_country.length)for(var d=0;d<c.length;d++){var s=i.runtime.list_set_value_name_country.indexOf(c[d]);-1!=s&&(c[d]=q[s])}for(var g=0;g<c.length;g++)u[c[g]]="";f=c;for(var h=0;h<n.length;h++){o=n[h].getAttribute("name"),n[h].required&&-1==w.indexOf(o)&&w.push(o);var y=null;if("INPUT"==n[h].tagName){y=n[h].getAttribute("type").trim().toLowerCase();var v=n[h].getAttribute("pattern"),E=n[h].getAttribute("title");if("email"==y?O.push({name:o,pattern:'(([^<>()\\[\\]\\\\.,;:\\s@"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@"]+)*)|(".+"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))',pattern_flag:"gi",title:i.const.LANG.FORM_INPUT_EMAIL_REGEX}):isEmptyLadiPage(v)||O.push({name:o,pattern:v,title:isEmptyLadiPage(E)?i.const.LANG.FORM_INPUT_TEXT_REGEX:E}),"checkbox"==y){isArrayLadiPage(u[o])||(u[o]=[]),n[h].checked&&u[o].push(n[h].value);continue}if("radio"==y){n[h].checked&&(u[o]=n[h].value);continue}}if(u[o]=n[h].value,n[h].classList.contains("ladi-form-control-file")&&(u[o]=JSON.parse(n[h].getAttribute("data-path-file")||"[]"),m[o]=!0),"coupon"==o&&"INPUT"==n[h].tagName&&"text"==y&&"true"==n[h].getAttribute("data-replace-coupon")&&(u[o]=i.runtime.tmp.current_use_coupon||""),"INPUT"==n[h].tagName&&"date"==y&&!isEmptyLadiPage(u[o])){var k=n[h].getAttribute("date-format")||"dd-mm-yyyy",L=new Date(u[o]),P=k;P=(P=(P=(P=P.replaceAll("dd",(L.getDate()<10?"0":"")+L.getDate())).replaceAll("mm",(L.getMonth()+1<10?"0":"")+(L.getMonth()+1))).replaceAll("yyyy",L.getFullYear())).replaceAll("yy",L.getFullYear()-2e3),u[o]=P,l[o]=k}}var b=e.querySelector('[name="product_name_convert"]');if(b&&u.products){var A=u.products,S="";S=-1!==A.indexOf("|")?A.split("|")[1].trim():A.trim(),u.product_name_convert=S,b.value=S}return t||N.forEach(function(e){isNullLadiPage(u[e])||i.setCookieDomains("_ladipage_"+e,Base64.encode(u[e]),365)}),_=i.runtime.tmp.convertFormDataObjectCountry(u),{formDataObject:u,listInputRegex:O}},I=function(e,t,a,c,p){var _=i.runtime.website_id,g={form_config_id:h,ladi_form_id:v,ladipage_id:i.runtime.ladipage_id,tracking_form:[],form_data:[],data_key:c};if(isEmptyLadiPage(_)||(g.website_id=_),a)g.status_send=i.const.STATUS_SEND.capture;else if(g.status_send=i.const.STATUS_SEND.sendform,S){var w=window.ladi("_checkout_token").get_cookie();isEmptyLadiPage(w)||(g.checkout_token=w)}try{Array.from(document.querySelectorAll("#"+v+' .ladi-element[data-form-checkout-item="product"] .ladi-form-checkout-payment-check.checked')).forEach(function(e){var t=i.findAncestor(e,"ladi-form-checkout-box"),n=i.parseFormCheckoutProduct(t);n.quantity=1;var a=t.querySelector(".ladi-form-checkout-payment-quantity input");isEmptyLadiPage(a)||(n.quantity=parseInt(a.value)||n.quantity),isArrayLadiPage(g.product_checkout)||(g.product_checkout=[]),g.product_checkout.push(`${n.product_variant_id}:${n.quantity}:${n.price}::|${n.name}`)});const e=document.getElementById(`${v}`).querySelector("[data-shipping-fee][data-shipping-name]");if(e){const t=e.getAttribute("data-shipping-fee"),n=e.getAttribute("data-shipping-name");g.shipping_lines=[{title:isEmptyLadiPage(n)?"_":n,price:t}]}}catch(e){}var O=document.querySelector("#"+v+' div[data-is-merge-address="true"]'),N=!!O&&"true"==O.getAttribute("value");if(isEmptyLadiPage(N)||(g.merge_address=N),isEmptyLadiPage(t.voucher_id)||(g.voucher_id=t.voucher_id),isEmptyLadiPage(t.voucher_code)||(g.voucher_code=t.voucher_code),!isEmptyLadiPage(E)){var C=E.getElementsByClassName("ladiflow-widget")[0];isEmptyLadiPage(C)||(isObjectLadiPage(g.options)||(g.options={}),g.options.ladiflow_trigger_id=C.getAttribute("ladiflow-trigger-id"),g.options.ladiflow_ref=C.getAttribute("ladiflow-ref"),g.options.ladiflow_page_id=C.getAttribute("page_id"),g.options.ladiflow_checkbox_user_ref=C.getAttribute("user_ref"),g.options.ladiflow_store_id=C.getAttribute("ladiflow-store-id"),d=1e3,s=function(){isObjectLadiPage(window.LadiFlow)&&isFunctionLadiPage(window.LadiFlow.resetWidgetCheckbox)&&window.LadiFlow.resetWidgetCheckbox(C.id)})}isEmptyLadiPage(k)||(["option.sync_ladisales_form_account_id","option.sync_ladiflow_form_account_id","option.sync_ladishare_form_account_id","option.sync_ladichat_form_account_id"].forEach(function(e){isEmptyLadiPage(k[e])||(isObjectLadiPage(g.options)||(g.options={}),isArrayLadiPage(g.options.external_form_config_ids)||(g.options.external_form_config_ids=[]),g.options.external_form_config_ids.push(k[e]))}),k["option.use_data_leads"]&&(isObjectLadiPage(g.options)||(g.options={}),g.options.data_leads=!0)),t.isFormOtp&&!isEmptyLadiPage(y)&&(isObjectLadiPage(g.options)||(g.options={}),isObjectLadiPage(g.options.external_otp_config)||(g.options.external_otp_config={}),g.options.external_otp_config.otp_config_id=y),isObjectLadiPage(g.options)&&(g.options=JSON.stringify(g.options)),isEmptyLadiPage(L)||(g.total_revenue=L),isEmptyLadiPage(i.runtime.time_zone)||(g.time_zone=i.runtime.time_zone);var q=Object.keys(LadiFormApi);if(f=function(e){var t=[],n=0,a=["state","district","ward"];for(n=0;n<e.length&&!a.includes(e[n]);n++)t.push(e[n]);var i=Array.from(document.querySelectorAll("#"+v+" .ladi-form-control[data-select-index]")),o=Array.from(document.querySelectorAll("#"+v+' input.ladi-form-control[data-select-index][name="ward"]')),r=i.map(function(e){return(parseInt(e.getAttribute("data-select-index"))||0)+"|"+e.getAttribute("name")});for(r.sort(function(e,t){return parseInt(e.split("|")[0])-parseInt(t.split("|")[0])}),i=r.map(function(e){return e.split("|")[1]}),n=0;n<i.length;n++)t.push(i[n]);for(i.length>0&&t.push("country"),isEmptyLadiPage(o)||t.except(["ward"]),n=t.length;n<e.length;n++)t.push(e[n]);return t=t.unique(),t=JSON.stringify(t),JSON.parse(t)}(f),f.forEach(function(e){var t=u[e];if(isArrayLadiPage(t)&&0==t.length&&(t=""),t=-1!=q.indexOf(e)?LadiFormApi[e]:t,"products"==e&&-1!=f.indexOf("quantity"))try{var n=t.split("|");if(2==n.length){var a=n[0].split(":");5==a.length&&(a[1]=u.quantity),n[0]=a.join(":")}t=n.join("|")}catch(e){}var i={name:e,value:t};m[e]&&(i.is_file=!0),isEmptyLadiPage(l[e])||(i.format=l[e]),g.form_data.push(i)}),(q=q.except(f)).forEach(function(e){g.form_data.push({name:e,value:LadiFormApi[e]})}),S){if(!isNullLadiPage(P)){g.form_data.push({name:"cart_products",value:P,is_ladipage:!0}),isEmptyLadiPage(i.runtime.tmp.add_to_cart_shipping_method_id)||g.form_data.push({name:"cart_shipping",value:i.runtime.tmp.add_to_cart_shipping_method_id+"|"+(i.runtime.tmp.add_to_cart_fee_shipping||0),is_ladipage:!0});var R=g.form_data.findIndex(function(e){return"coupon"==e.name});-1!=R&&(g.form_data[R].is_ladipage=!0)}isEmptyLadiPage(L)||g.form_data.push({name:"cart_revenue",value:L,is_ladipage:!0}),isEmptyLadiPage(i.runtime.tmp.current_use_coupon)||g.form_data.push({name:"cart_coupon_amount",value:i.runtime.tmp.add_to_cart_discount||0,is_ladipage:!0})}g.tracking_form.push({name:"url_page",value:window.location.href}),i.runtime.has_popupx&&g.tracking_form.push({name:"origin_url_page",value:i.runtime.tmp.popupx_origin_url}),x.forEach(function(e){var t=T[e];t=isNullLadiPage(t)?"":t,g.tracking_form.push({name:e,value:t})}),g.tracking_form.push({name:"variant_url",value:o}),g.tracking_form.push({name:"variant_content",value:i.generateVariantContentString(r,!0)}),isEmptyLadiPage(n)||g.tracking_form.push({name:i.const.REF_NAME,value:n}),i.runtime.tmp["form_data_ladi_tmp_"+v]=i.copy(g);var D=i.runtime.tmp["form_data_ladi_"+v];isObjectLadiPage(D)&&(g=i.copy(D)),isEmptyLadiPage(b)||(g.captcha_token=b,g.captcha_type=A);function F(e,t){var n=window.ladi(e).get_cookie();isEmptyLadiPage(n)||(console.log(e,n),g[t]=n)}t.isFormOtp&&(t.isSetOtpId&&function(){var e="_otp_id_"+v,n=window.ladi(e).get_cookie(),a=!1,o=i.runtime.tmp["cookie_cache_otp_"+v];isEmptyLadiPage(n)&&isObjectLadiPage(o)&&!isEmptyLadiPage(o[e])&&(n=o[e],a=!0);var r=new Date,c=[];isEmptyLadiPage(n)?c=[i.randomId(),r.getTime(),1]:((c=n.split("|"))[1]=parseInt(c[1])||Date.now(),c[2]=parseInt(c[2])||1,t.isSendOtp||(c[2]+=1),c.splice(3)),c[2]<=1?g.otp_send=i.const.OTP_TYPE.send:g.otp_send=i.const.OTP_TYPE.resend,r.setTime(c[1]+9e5),n=c.join("|"),a?(o[e]=n,i.runtime.tmp["cookie_cache_otp_"+v]=o):window.ladi(e).set_cookie(n,r),c.splice(1),n=c.join("|"),g.otp_id=n}(),g.is_capture=t.isCapture,g.otp_type=i.const.OTP_TYPE.sms,g.status_send=i.const.STATUS_SEND.otp),t.isSendOtp&&(g.otp_code=t.otp_code,g.status_send=i.const.STATUS_SEND.sendform),F("_fbc","data_fbc"),F("_fbp","data_fbp"),F("_fbq","data_fbq");try{var I=document.getElementById(v).getAttribute("data-fb-event-id");I&&(g.event_id=I)}catch(e){}isFunctionLadiPage(p)&&p(g)},M=function(e){e.reset();var t=e.getElementsByClassName("ladi-survey-option");for(X=0;X<t.length;X++)t[X].classList.remove("selected");var n=e.querySelectorAll(".ladi-element .ladi-form-item-container .ladi-form-checkbox-item input");for(X=0;X<n.length;X++){var a=i.findAncestor(n[X],"ladi-form-checkbox-item").querySelector("span");isEmptyLadiPage(a)||a.setAttribute("data-checked",n[X].checked)}var o=i.findAncestor(e,"ladi-element");if(!isEmptyLadiPage(o)){for(var r=document.querySelectorAll('.ladi-form [data-submit-form-id="'+o.id+'"]'),c=0;c<r.length;c++){var d=i.findAncestor(r[c],"ladi-form");if(!isEmptyLadiPage(d)&&(d=i.findAncestor(d,"ladi-element"),!isEmptyLadiPage(d))){var s=d.querySelector(".ladi-form-remove-coupon");if(isEmptyLadiPage(s)){var u=d.querySelector('input[name="coupon"]');isEmptyLadiPage(u)||(u.value="",i.fireEvent(u,"change"))}else s.click()}}var l=document.getElementById(o.getAttribute("data-form-id-before"));isEmptyLadiPage(l)||o.id==l.id||(l=l.getElementsByClassName("ladi-form")[0],M(l))}for(var p=document.querySelectorAll('[data-combobox-type="delivery_method"]'),m=0;m<p.length;m++)p[m].hasAttribute("data-placeholder")&&(p[m].innerHTML='<option value="">'+p[m].getAttribute("data-placeholder")+"</option>"),p[m].setAttribute("data-selected","");for(var _=document.querySelectorAll(".ladi-google-recaptcha-checkbox[data-widget-id]"),g=0;g<_.length;g++){var f=_[g].getAttribute("data-widget-id");isEmptyLadiPage(f)||window.grecaptcha&&isObjectLadiPage(i.runtime.tmp.google_captcha)&&i.runtime.tmp.google_captcha.checkbox&&isFunctionLadiPage(window.grecaptcha.reset)&&window.grecaptcha.reset(f)}var h=document.querySelectorAll(".ladi-form .ladi-form-checkbox-box-item");for(g=0;g<h.length;g++)i.runFormItemOtherChange(h[g].getElementsByClassName("ladi-form-checkbox-item")[0],!0);i.runtime.tmp.add_to_cart_shipping_method_id=null},j=function(e,t,n,a){if(F(n,!1),t.isSendFormCheckout){var o=i.findAncestor(n,"ladi-element"),r=o.querySelector(".ladi-button");return r=i.findAncestor(r,"ladi-element"),i.runEventTracking(o.id,{is_return_string:t.isSendFormCheckout,is_form:!0,event:{target:r}},u),void i.sendFormCheckout(n,{setFormData:F,resetFormValue:M,setFormDataObjectThankyou:G,checkValidate:D})}D(n,!1,null)&&(I(0,t,!1,a,function(e){i.sendRequest("POST",i.const.API_FORM_DATA,JSON.stringify(e),!0,{"Content-Type":"application/json"})}),i.showMessage(i.const.LANG.FORM_SEND_DATA_NO_CONFIG),M(n))},U=function(){i.showMessage(i.const.LANG.FORM_CAPTCHA_ERROR)},Y=function(e,t){var n={},a=function(e){return"form_show_popup_default"==e.type&&(isEmptyLadiPage(e.text_thankyou_value)||(e.text_thankyou_value=i.convertDataReplaceStr(e.text_thankyou_value,!1,null,!1,g))),"form_redirect_url"==e.type&&(isEmptyLadiPage(e.redirect_url)||(e.redirect_url=window.ladi(e.redirect_url).encode_thankyou_url(),e.redirect_url=window.ladi(e.redirect_url).get_url(p,t,!1))),"form_open_app_mobile"==e.type&&(i.runtime.isBrowserDesktop||isEmptyLadiPage(e.app_link)?e.app_link="":(e.app_link=window.ladi(e.app_link).encode_thankyou_url(),e.app_link=i.convertDataReplaceStr(e.app_link,!0,null,!1,g))),e};try{n=JSON.parse(e["option.funnelx_config"])}catch(e){}n=isObjectLadiPage(n)?n:{},isArrayLadiPage(n.configs)&&n.configs.forEach(function(e,t){n.configs[t].actions=e.actions.map(a)}),isArrayLadiPage(n.default_actions)&&(n.default_actions=n.default_actions.map(a));var o=i.copy(g);LadiPageScript.runtime.tmp.runActionPopupX({ladipage_id:i.runtime.ladipage_id,form_data:o,funnelx_config:n,action:{type:"thankyou_form_funnelx"}})},B=function(e,t,n,a,o){if(_={},g={},f=[],w=[],O=[],F(e,n),D(e,n,a)){for(var r=e.querySelectorAll(".ladi-element .ladi-form-item-container [name]"),c={},d={},s=null,l=0;l<r.length;l++){s=i.findAncestor(r[l],"ladi-element");var p=r[l].getAttribute("name");c[p]=s.id,d[p]=s.outerHTML}var m=t["option.form_setting"],h=Object.keys(c),y=function(t){var u=document.getElementById(t);if(!isEmptyLadiPage(u)){u.setAttribute("data-form-id-before",e.id);var p=i.runtime.eventData[u.id];if(!n||!isEmptyLadiPage(p)&&p["option.form_auto_capture"]){isFunctionLadiPage(o.getOtp)&&!isEmptyLadiPage(p)&&p["option.is_form_otp"]&&(isFunctionLadiPage(o.beforeRunOtp)&&o.beforeRunOtp(u),i.runtime.func_get_code_otp[u.id]=o.getOtp);var m=[];if(h.forEach(function(e){var t=window.ladi(c[e]).value();if(0==(r=u.querySelectorAll('.ladi-element .ladi-form-item-container [name="'+e+'"]')).length){var n=document.createElement("div");n.innerHTML=d[e],(n=n.childNodes[0]).id=i.randomString(10),n.classList.add("ladi-hidden"),u.getElementsByClassName("ladi-form")[0].appendChild(n),r=[n.querySelector('[name="'+e+'"]')]}var o=[];for(l=0;l<r.length;l++)s=i.findAncestor(r[l],"ladi-element"),o.push(s.id),e==a&&m.push(r[l]);for(o=o.unique(),l=0;l<o.length;l++)window.ladi(o[l]).value(t)}),n)for(l=0;l<m.length;l++)i.fireEvent(m[l],"focusout")}}};if((m.mapping_form_id||[]).forEach(y),!n){i.runtime.is_funnelx&&(i.runtime.tmp.multipleFormRunFormParent=y,G(),Y(t,!1));var v=t["option.data_event"];if(!isArrayLadiPage(v)){var E=i.copy(m);if(v=[],isObjectLadiPage(E)&&(E.type=E.event_type,E.value=E.event_value,E.is_hide_parent=E.event_is_hide_parent,E.change_index_type=E.event_change_index_type,E.change_index_number=E.event_change_index_number,!isEmptyLadiPage(E.value))){if(E.type!=i.const.DATA_ACTION_TYPE.section&&E.type!=i.const.DATA_ACTION_TYPE.popup||v.push({action_type:i.const.ACTION_TYPE.complete,type:E.type,action:E.value}),E.type==i.const.DATA_ACTION_TYPE.section&&E.is_hide_parent||E.type==i.const.DATA_ACTION_TYPE.popup){var k=i.findAncestor(e,"ladi-popup"),L=i.findAncestor(e,"ladi-section"),P=null;isEmptyLadiPage(k)?isEmptyLadiPage(L)||(P=L.id):P=(k=i.findAncestor(k,"ladi-element")).id,isEmptyLadiPage(P)||v.push({action_type:i.const.ACTION_TYPE.complete,type:i.const.DATA_ACTION_TYPE.hidden_show,hidden_ids:[P],show_ids:[]})}E.type==i.const.DATA_ACTION_TYPE.change_index&&v.push({action_type:i.const.ACTION_TYPE.complete,type:E.type,action:E.value,change_index_type:E.change_index_type,change_index_number:E.change_index_number})}}i.runtime.tmp.runDataEventNow(e,v,{action_type:i.const.ACTION_TYPE.complete})}o.isRunTracking&&i.runEventTracking(e.id,{is_form:!0,is_form_multiple:!0},u)}},G=function(){p=i.copy(u),g=i.copy(_),isObjectLadiPage(i.runtime.tmp.form_data_otp_current)&&(p=i.copy(i.runtime.tmp.form_data_otp_current)),Object.keys(i.runtime.replaceStr).forEach(function(e){p.hasOwnProperty(e)||(p[e]=i.runtime.replaceStr[e]),g.hasOwnProperty(e)||(g[e]=i.runtime.replaceStr[e])});var e=[];return isEmptyLadiPage(n)||e.push({key:i.const.REF_NAME,value:n}),e.forEach(function(e){p.hasOwnProperty(e.key)||(p[e.key]=e.value),g.hasOwnProperty(e.key)||(g[e.key]=e.value)}),{formDataObjectThankyou:p,formDataObjectConvertThankyou:g}},H=function(t,n,a,o,r,c){if(n=isObjectLadiPage(n)?n:{},!(c=isObjectLadiPage(c)?c:{}).isSendFormCheckout||i.checkValidateSendFormCheckout(t))if(T=i.getURLSearchParams(null,null,!1),d=0,s=null,u={},l={},p={},m={},_={},g={},f=[],h=null,y=null,v=null,E=null,k=null,L=null,P=null,b=n.captcha_token,isObjectLadiPage(i.runtime.tmp.google_captcha)&&(A=i.runtime.tmp.google_captcha.type,!a&&isEmptyLadiPage(b)&&n.hasOwnProperty("captcha_token")))U();else{w=[],O=[],S=i.findAncestor(t,"ladi-popup"),isEmptyLadiPage(S)?S=!1:(S=i.findAncestor(S,"ladi-element"),S=!isEmptyLadiPage(S)&&"POPUP_CHECKOUT"==S.id);var N=t.getElementsByClassName("ladi-form")[0];if(!isEmptyLadiPage(N)){var C=i.runtime.eventData[t.id];if(!isEmptyLadiPage(C)){if(C["option.is_add_to_cart"])return;h=C["option.form_config_id"],y=isObjectLadiPage(C["option.form_setting"])?C["option.form_setting"].otp_config_id:null,v=t.id,E=t,k=C,L=parseFloatLadiPage(C["option.form_purchase_value"])||0,S&&(L=i.getCartCheckoutPrice(L),P=i.getCartProducts())}var q=null,R=t.getAttribute("data-button-submit-other"),B=null,J=null;if(a){if(isEmptyLadiPage(o))return;if(F(N,a),!D(N,a,r))return;if(n.captcha&&!isEmptyLadiPage(C)&&C["option.form_captcha"]&&isObjectLadiPage(i.runtime.tmp.google_captcha)){if(window.grecaptcha)if(i.runtime.tmp.google_captcha.enterprise&&window.grecaptcha.enterprise)window.grecaptcha.enterprise.ready(function(){try{window.grecaptcha.enterprise.execute(i.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(e){H(t,{captcha_token:e},a,o,r,c)})}catch(e){}});else if(i.runtime.tmp.google_captcha.checkbox)try{q=t.getElementsByClassName("ladi-google-recaptcha-checkbox")[0],isEmptyLadiPage(R)||(q=document.querySelector("#"+R+" .ladi-google-recaptcha-checkbox")),B=q.getAttribute("data-widget-id"),J=window.grecaptcha.getResponse(B),H(t,{captcha_token:J},a,o,r,c)}catch(e){}else window.grecaptcha.ready(function(){try{window.grecaptcha.execute(i.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(e){H(t,{captcha_token:e},a,o,r,c)})}catch(e){}});return}I(0,c,a,o,function(e){var t=e.form_data.findIndex(function(e){return e.name==r}),n=-1!=t?e.form_data[t].value:null;!isEmptyLadiPage(i.runtime.tmp.capture_form_data_last[o+"_"+r])&&equalsLadiPage(i.runtime.tmp.capture_form_data_last[o+"_"+r],n)||(i.runtime.tmp.capture_form_data_last[o+"_"+r]=n,i.sendRequest("POST",i.const.API_FORM_DATA,JSON.stringify(e),!0,{"Content-Type":"application/json"}))})}else if(isEmptyLadiPage(C))j(0,c,N,o);else if(isNullLadiPage(i.runtime.tmp.form_sending)&&(i.runtime.tmp.form_sending={}),isNullLadiPage(i.runtime.tmp.form_button_headline)&&(i.runtime.tmp.form_button_headline={}),!i.runtime.tmp.form_sending[t.id]){var K=function(){i.runtime.tmp.form_sending[t.id]=!0;var e=N.querySelector(".ladi-button .ladi-headline");isNullLadiPage(i.runtime.tmp.form_button_headline[t.id])&&(i.runtime.tmp.form_button_headline[t.id]=e.innerHTML),c.isFormOtp||(e.innerHTML="● ● ●")},$=N.getElementsByClassName("ladi-button")[0];$=i.findAncestor($,"ladi-element"),isEmptyLadiPage(R)||($=document.getElementById(R));var V=function(){delete i.runtime.tmp.form_sending[t.id],N.querySelector(".ladi-button .ladi-headline").innerHTML=i.runtime.tmp.form_button_headline[t.id]},W=function(e){try{var n=t.querySelector(`.ladi-element .ladi-form-item input.ladi-form-control[name="${e}"]`);return n?n.value:""}catch(e){}return""};if(isNullLadiPage(c.voucher_id)&&!isEmptyLadiPage(C)&&C["option.form_set_voucher_id"])return K(),void function(e){i.runtime.tmp.voucher_info={};var t={event:"getVoucher",voucher_id:C["option.form_set_voucher_id"],store_id:i.runtime.store_id,time_zone:i.runtime.time_zone,domain:window.location.host,url:window.location.href,customer:W(C["option.form_customer_input_name"]),ladipage_id:i.runtime.ladipage_id};i.sendRequest("POST",i.const.API_ANALYTICS_CONFIG,JSON.stringify(t),!0,{"Content-Type":"application/json"},function(t,n,a){if(a.readyState==XMLHttpRequest.DONE&&isFunctionLadiPage(e))try{var o=JSON.parse(t);i.runtime.tmp.voucher_info={voucher_id:o.data.id||"",voucher_code:o.data.voucher_code,message:o.message},e(i.runtime.tmp.voucher_info.voucher_id,i.runtime.tmp.voucher_info.voucher_code),C["option.form_voucher_show_error"]&&isObjectLadiPage(i.runtime.tmp.voucher_info)&&isEmptyLadiPage(i.runtime.tmp.voucher_info.voucher_code)&&!isEmptyLadiPage(i.runtime.tmp.voucher_info.message)&&i.showMessage(i.runtime.tmp.voucher_info.message)}catch(t){e("","")}})}(function(e,i){V(),H(t,n,a,o,r,Object.assign(c,{voucher_id:e,voucher_code:i}))});if(n.captcha&&!isEmptyLadiPage(C)&&C["option.form_captcha"]&&isObjectLadiPage(i.runtime.tmp.google_captcha))if(window.grecaptcha)if(K(),i.runtime.tmp.google_captcha.enterprise&&window.grecaptcha.enterprise)window.grecaptcha.enterprise.ready(function(){try{window.grecaptcha.enterprise.execute(i.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(e){V(),H(t,{captcha_token:e},a,o,r,c)}).catch(function(){U(),V()})}catch(e){U(),V()}});else if(i.runtime.tmp.google_captcha.checkbox)try{q=t.getElementsByClassName("ladi-google-recaptcha-checkbox")[0],R=t.getAttribute("data-button-submit-other"),isEmptyLadiPage(R)||(q=document.querySelector("#"+R+" .ladi-google-recaptcha-checkbox")),B=q.getAttribute("data-widget-id"),J=window.grecaptcha.getResponse(B),V(),H(t,{captcha_token:J},a,o,r,c)}catch(e){U(),V()}else window.grecaptcha.ready(function(){try{window.grecaptcha.execute(i.runtime.tmp.google_captcha.api_key,{action:"submit"}).then(function(e){V(),H(t,{captcha_token:e},a,o,r,c)}).catch(function(){U(),V()})}catch(e){U(),V()}});else i.showMessage(i.const.LANG.FORM_CAPTCHA_LOADING);else{var z=C["option.form_send_ladipage"],Q=C["option.form_api_data"],X=C["option.thankyou_type"],Z=C["option.thankyou_value"],ee=C["option.deeplink_value"],te=C["option.set_cookie"],ne=C["option.form_auto_funnel"],ae=C["option.form_thankyou_funnel"],ie=C["option.only_facebook_widget"],oe=function(){if(p=Object.assign(p,i.runtime.tmp.voucher_info),g=Object.assign(g,i.runtime.tmp.voucher_info),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackOtpShowThankYouDone)&&c.callbackOtpShowThankYouDone(),isFunctionLadiPage(s)&&s(),C["option.form_voucher_show_thankyou_when_error"]||!C["option.form_voucher_show_error"]||!isObjectLadiPage(i.runtime.tmp.voucher_info)||!isEmptyLadiPage(i.runtime.tmp.voucher_info.voucher_code)||isEmptyLadiPage(i.runtime.tmp.voucher_info.message))if(i.runtime.is_funnelx)Y(C,ne);else{i.setFrequencyFormSubmit(t.id);try{te.forEach(function(e){for(var t=e.split(";").removeSpace().unique(),n=0;n<t.length;n++){var a=t[n].split("=").removeSpace();2==a.length&&window.ladi(a[0]).set_cookie(a[1])}})}catch(e){}var n=!1;if(i.runtime.has_popupx&&i.runtime.tmp.popupx_is_inline)n=!0;else if(X!=i.const.FORM_THANKYOU_TYPE.url){var a=i.findAncestor(t,"ladi-popup");isEmptyLadiPage(a)||(a=i.findAncestor(a,"ladi-element"),i.runRemovePopup(a.id,e))}var o=0;if(!i.runtime.isBrowserDesktop&&!isEmptyLadiPage(ee)){o=1e3,ee=window.ladi(ee).encode_thankyou_url();var r=i.convertDataReplaceStr(ee,!0,null,!1,g);window.ladi(r).open_url()}var d=window.ladi("LADI_FUNNEL_NEXT_URL").get_cookie();if(!ae||isEmptyLadiPage(d)){if(X==i.const.FORM_THANKYOU_TYPE.default&&(isEmptyLadiPage(Z)||i.showMessage(Z,g)),X==i.const.FORM_THANKYOU_TYPE.popup&&i.runTimeout(function(){ne&&(console.log("chay day",g,"thankyou_value",Z),i.setDataReplaceElement(!1,!1,g,Z)),window.ladi(Z).show(!1,{formThankyouPopupXInline:n})},100),X==i.const.FORM_THANKYOU_TYPE.section&&(ne&&i.setDataReplaceElement(!1,!1,g,Z),window.ladi(Z).show(!1)),X==i.const.FORM_THANKYOU_TYPE.url&&!isEmptyLadiPage(Z)){Z=window.ladi(Z).encode_thankyou_url();var u=window.ladi(Z).get_url(p,ne,!1);i.runTimeout(function(){window.ladi(u).open_url()},o)}}else{d=window.ladi(d).encode_thankyou_url();var l=window.ladi(d).get_url(p,ne,!1);i.runTimeout(function(){window.ladi(l).open_url()},o)}}},re=function(){c.isSendFormCheckout?i.sendFormCheckout(t,{setFormData:F,resetFormValue:M,setFormDataObjectThankyou:G}):isFunctionLadiPage(window.ladipage_before_thankyou)?window.ladipage_before_thankyou(t,oe):oe()};if(ie){if(isObjectLadiPage(window.LadiFlow)&&isFunctionLadiPage(window.LadiFlow.confirmCheckbox))for(var ce=t.getElementsByClassName("ladiflow-widget"),de=0;de<ce.length;de++)window.LadiFlow.confirmCheckbox(ce[de].id);return i.runEventTracking(t.id,{is_return_string:c.isSendFormCheckout,is_form:!0,is_facebook_widget:!0},u),void re()}if(isEmptyLadiPage(h)&&isEmptyLadiPage(C["option.sync_ladisales_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladiflow_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladishare_form_account_id"])&&isEmptyLadiPage(C["option.sync_ladichat_form_account_id"])&&(c.isSendFormCheckout||!C["option.use_data_leads"]))j(0,c,N,o);else if(F(N,a),D(N,a,r)){var se=0,ue=0,le=null,pe=!1,me=null,_e=[],ge=!1,fe=!1,he=!0,ye=function(e){e&&M(N),V()},ve=function(e){if(-1!=[i.const.FORM_CONFIG_TYPE.sapo,i.const.FORM_CONFIG_TYPE.shopify,i.const.FORM_CONFIG_TYPE.haravan,i.const.FORM_CONFIG_TYPE.wordpress].indexOf(i.runtime.shopping_product_type)&&i.runtime.tmp.cart.length>0){var t=!1;-1!=[i.const.FORM_CONFIG_TYPE.haravan,i.const.FORM_CONFIG_TYPE.wordpress].indexOf(i.runtime.shopping_product_type)&&(t=!0);var n=i.runtime.tmp.cart[0];return n=JSON.stringify(n),n=encodeURIComponent(n),void i.removeAddToCartProduct(n,!1,t,function(t){t?ve(e):isFunctionLadiPage(e)&&e()})}-1!=[i.const.FORM_CONFIG_TYPE.ladisales].indexOf(i.runtime.shopping_product_type)&&(window.ladi("_cart_token").delete_cookie(),window.ladi("_checkout_token").delete_cookie(),i.createCartData()),isFunctionLadiPage(e)&&e()},Ee=function(e,n,a,o){if(a.readyState==XMLHttpRequest.DONE){var r={};try{r=JSON.parse(e)}catch(e){}r=isObjectLadiPage(r)?r:{},o==i.const.API_FORM_DATA?(200==r.code?se++:(1!=r.code||isEmptyLadiPage(r.message)||(le=r.message),ue++,he=!1),r.code||(navigator.onLine?(le=i.convertDataReplaceStr(i.const.LANG.MESSAGE_NETWORK_HAS_CONNECT_BUT_NO_CODE_DATA,!1,null,!1,{status:n}),pe=!0):le=i.const.LANG.MESSAGE_NETWORK_ERROR)):200==n||201==n||i.getElementAHref(o).host==i.const.DOMAIN_GOOGLE_DOCS?se++:ue++,se+ue==_e.length&&(he&&!ge&&se>=1?(ge=!0,c.isResendOtp||(i.runtime.tmp.form_data_current=u),isFunctionLadiPage(c.callbackOtp)&&c.callbackOtp(!0),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackThankyou)?(V(),c.callbackThankyou(c,function(){ve(function(){ye(!0),i.runtime.tmp.current_use_coupon=null})})):(G(),function(e,t,n){var a=null,o=!1,r=function(e,t){o||(isFunctionLadiPage(n)&&n(e,t),i.removeTimeout(a),o=!0)};a=i.runTimeout(r,3e3),i.runtime.tmp.runTrackingAnalytics("FormSubmit",{ladi_form_id:e,total_revenue:t},r)}(t.id,L,function(e,n){i.runEventTracking(t.id,{is_return_string:c.isSendFormCheckout,is_form:!0,event:{target:$}},u),window.ladi("_capture_"+t.id).delete_cookie(),isObjectLadiPage(c)&&isFunctionLadiPage(c.callbackOtpDone)&&c.callbackOtpDone(),ve(function(){i.runTimeout(function(){i.runtime.tmp.current_use_coupon=null,re(),ye(!0)},500)})}))):!fe&&ue>=1&&(isFunctionLadiPage(c.callbackOtp)&&c.callbackOtp(!1),fe=!0,i.showMessage(le||i.const.LANG.REQUEST_SEND_ERROR),pe&&!isEmptyLadiPage(me)&&(me=JSON.parse(me),i.sendRequest("POST",i.const.API_FORM_DATA_ERROR_RESPONSE,me.data,me.async,me.headers),me=null),ye(!1)))}},ke=function(e){_e.push({url:i.const.API_FORM_DATA,data:JSON.stringify(e),async:!0,headers:{"Content-Type":"application/json"},callback:Ee}),me=JSON.stringify(_e[_e.length-1])},Le=function(){0==_e.length&&(z?j(0,c,N,o):I(0,c,a,o,ke)),_e.forEach(function(e){i.sendRequest("POST",e.url,e.data,e.async,e.headers,e.callback)})},Pe=function(){z&&I(0,c,a,o,ke),isArrayLadiPage(Q)&&Q.forEach(function(e){if(!isEmptyLadiPage(e.api_url)&&isArrayLadiPage(e.custom_fields)){var t=i.getElementAHref(e.api_url).host==i.const.DOMAIN_GOOGLE_DOCS,n={},a=null,o=null,r=null,c=null;e.custom_fields.forEach(function(e){if(S&&("cart_products"==e.ladi_name&&(a=e.name),"cart_revenue"==e.ladi_name&&(o=e.name),"cart_shipping"==e.ladi_name&&(r=e.name),"cart_coupon_amount"==e.ladi_name&&(c=e.name)),!m[e.ladi_name]){var t=_[e.ladi_name];isNullLadiPage(t)||(isArrayLadiPage(t)?0==t.length?n[e.name]="":n[e.name]=JSON.stringify(t):n[e.name]=t)}}),isEmptyLadiPage(a)||isNullLadiPage(P)||(n[a]=JSON.stringify(P)),isEmptyLadiPage(o)||isNullLadiPage(L)||(n[o]=L),isEmptyLadiPage(r)||isNullLadiPage(i.runtime.tmp.add_to_cart_shipping_method_id)||(n[r]=i.runtime.tmp.add_to_cart_shipping_method_id+"|"+(i.runtime.tmp.add_to_cart_fee_shipping||0)),isEmptyLadiPage(c)||isEmptyLadiPage(i.runtime.tmp.current_use_coupon)||(n[c]=i.runtime.tmp.add_to_cart_discount||0);var d={};if(!isEmptyLadiPage(e.api_request_header))try{var s=JSON.parse(e.api_request_header);Object.keys(s).forEach(function(e){d[e]=s[e]})}catch(e){}if(!t)n.link=window.location.href,i.runtime.has_popupx&&(n.origin_link=i.runtime.tmp.popupx_origin_url),Object.keys(LadiFormApi).forEach(function(e){n[e]=LadiFormApi[e]}),x.forEach(function(e){var t=T[e];isNullLadiPage(t)||(n[e]=t)});var u=null,l=e.content_type||i.const.CONTENT_TYPE.form_urlencoded;if(l==i.const.CONTENT_TYPE.form_urlencoded&&(d["Content-Type"]="application/x-www-form-urlencoded",u=Object.keys(n).reduce(function(e,t){return e.push(t+"="+encodeURIComponent(n[t])),e},[]).join("&")),l==i.const.CONTENT_TYPE.json&&(d["Content-Type"]="application/json",u=JSON.stringify(n)),l==i.const.CONTENT_TYPE.form_data)u=new FormData,Object.keys(n).forEach(function(e){u.append(e,n[e])});_e.push({url:e.api_url,data:u,async:!0,headers:d,callback:Ee})}}),(_e.length>0||!z)&&K(),i.runTimeout(Le,d)};if(t.classList.contains("ladi-form-unique")){var be=t.querySelector('input[name="email"]'),Ae=t.querySelector('input[name="phone"]'),we=t.querySelector('select[name="products"]'),Oe={email:be?be.value:"",phone:Ae?Ae.value:"",product_variant_id:function(e){try{return e.split(":")[0]}catch(t){return e}}(we?we.value:""),store_id:i.runtime.store_id,domain:window.location.host,url:window.location.href,ladipage_id:i.runtime.ladipage_id};if(isEmptyLadiPage(Oe.email)&&isEmptyLadiPage(Oe.phone)||isEmptyLadiPage(Oe.product_variant_id))return void i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR);i.sendRequest("POST",i.const.API_LADISALE_CUSTOMER_CHECK_UNIQUE,JSON.stringify(Oe),!0,{"Content-Type":"application/json"},function(e,t,n,a){if(n.readyState==XMLHttpRequest.DONE)try{var o=JSON.parse(e);if(200!=o.code||o.data.is_buy)return i.showMessage(o.message);Pe()}catch(e){console.error(e),i.showMessage(i.const.LANG.REQUEST_SEND_ERROR)}})}else Pe()}}}}}},J=function(e){var t=i.findAncestor(e.target,"ladi-element");if(!isEmptyLadiPage(t))for(var n=t.querySelectorAll('[type="checkbox"]'),a=0;a<n.length;a++)n[a].removeAttribute("required")},K=function(e){var t=i.findAncestor(e.target,"ladi-element");if(!isEmptyLadiPage(t)){if("false"==t.getAttribute("data-submit"))return!1;var a=1e10,o="ladi."+Date.now()+"."+(Math.floor(9e10*Math.random())+a);t.setAttribute("data-fb-event-id",o),i.removeTimeout(i.runtime.tmp.timeout_form_submit_id),i.runtime.tmp.timeout_form_submit_id=i.runTimeout(function(){delete i.runtime.tmp.timeout_form_submit_id},500);var r=null;if((!isArrayLadiPage(i.runtime.tmp.cart)||i.runtime.tmp.cart.length<=0)&&(r=i.findAncestor(t,["ladi-popup","ladi-element"]),!isEmptyLadiPage(r)&&"POPUP_CHECKOUT"==r.id))return i.showMessage(i.const.LANG.ADD_TO_CART_NO_CART),!1;delete i.runtime.tmp.form_data_otp_current,i.setEventDataFormDynamic(t.id);var c=i.runtime.eventData[t.id];if(!isObjectLadiPage(c))return!1;if(c["option.is_form_otp"])return!1;for(var d=t.querySelectorAll('[ladi-checkbox-required="true"]'),s=-1,l=0;l<d.length;l++)if(0==d[l].querySelectorAll('[type="checkbox"]:checked').length){s=l;break}if(-1==s){var p=function(e){var n=!1,a=null;isEmptyLadiPage(c["option.form_config_id"])||((c["option.form_auto_capture"]||e.isFormOtp)&&(a=R(t.id,c["option.form_config_id"])),c["option.form_auto_capture"]&&(n=!0));var i={captcha:!0};(e.isResendOtp||e.isSendOtp)&&(i.captcha=!1),e.isFormOtp&&(e.isCapture=n),H(t,i,!1,a,null,e)},m=function(e){window.ladi("_capture_"+t.id).delete_cookie(),window.ladi("_otp_id_"+t.id).delete_cookie();var n=[];isObjectLadiPage(c["option.form_setting"])&&(n=c["option.form_setting"].mapping_form_id||[]),n.forEach(function(t){window.ladi("_otp_time_"+t).delete_cookie(),e&&delete i.runtime.tmp["cookie_cache_otp_"+t]}),e&&(delete i.runtime.tmp["cookie_cache_otp_"+t.id],delete i.runtime.tmp["form_data_ladi_"+t.id],delete i.runtime.tmp["form_data_ladi_tmp_"+t.id])},h=function(e){i.runtime.tmp.form_data_otp_current=i.runtime.tmp.form_data_current;var t=e.getElementsByClassName("ladi-form")[0];r=i.findAncestor(e,["ladi-popup","ladi-element"]);var n=function(){var n=e.getAttribute("data-form-id-before");delete i.runtime.func_get_code_otp[e.id],delete i.runtime.tmp["cookie_cache_otp_"+e.id],delete i.runtime.tmp["cookie_cache_otp_"+n],delete i.runtime.tmp["form_data_ladi_"+n],delete i.runtime.tmp["form_data_ladi_tmp_"+n],window.ladi("_otp_time_"+e.id).delete_cookie(),window.ladi("_otp_id_"+n).delete_cookie(),e.removeAttribute("data-form-id-before"),t.onsubmit=function(){return!1}},a=function(){isEmptyLadiPage(r)||window.ladi(r.id).hide(),t.reset()};t.onsubmit=function(){if("false"==e.getAttribute("data-submit"))return!1;var t=e.querySelector('input[name="otp"]');return isEmptyLadiPage(t)||(t=t.value.trim(),p({isFormOtp:!0,isSetOtpId:!0,isSendOtp:!0,otp_code:t,callbackOtpDone:n,callbackOtpShowThankYouDone:a})),!1}},y=function(e,t){p({isFormOtp:!0,isSetOtpId:!0,isResendOtp:e,callbackOtp:t,callbackThankyou:v})},v=function(e,n){e.isFormOtp&&!e.isResendOtp&&function(){var e={};e["_capture_"+t.id]=null,e["_otp_id_"+t.id]=null;var n=Object.keys(e);n.forEach(function(t){e[t]=window.ladi(t).get_cookie()}),i.runtime.tmp["cookie_cache_otp_"+t.id]=e;var a=[];isObjectLadiPage(c["option.form_setting"])&&(a=c["option.form_setting"].mapping_form_id||[]),a.forEach(function(t){(e={})["_otp_time_"+t]=null,(n=Object.keys(e)).forEach(function(t){e[t]=window.ladi(t).get_cookie()}),i.runtime.tmp["cookie_cache_otp_"+t]=e}),i.runtime.tmp["form_data_ladi_"+t.id]=i.runtime.tmp["form_data_ladi_tmp_"+t.id]}(),m(!1),B(t,c,!1,null,{isRunTracking:!1,getOtp:y,beforeRunOtp:h}),isFunctionLadiPage(n)&&n()};if(isObjectLadiPage(c)&&c["option.is_form_login"])!function(e){var t=e.querySelector('input[name="access_key"]');if(!isEmptyLadiPage(t)&&!isEmptyLadiPage(t.value)){for(var n=[],a=0,o=1;o<=50;o++){var r=window.ladi("_login_token_"+o).get_cookie();0==a&&isEmptyLadiPage(r)&&(a=o),n.push(r)}if(0==a){for(o=1;o<=50;o++)window.ladi("_login_token_"+o).delete_cookie();n=[],a=1}i.sendRequest("POST",i.const.API_ACCESS_KEY_LOGIN,JSON.stringify({language:i.runtime.lang,tokens:n.removeSpace(),url:window.location.href,code:t.value.toUpperCase()}),!0,{"Content-Type":"application/json"},function(e,t,o,r){if(o.readyState==XMLHttpRequest.DONE){var c={},d=i.const.LANG.FORM_LOGIN_SEND_ERROR;try{if(200==(c=JSON.parse(e)).code){var s=n.findIndex(function(e){return e==c.data.token});-1!=s&&(a=s+1),window.ladi("_login_token_"+a).set_cookie(c.data.token,7);var u=i.getElementAHref(c.data.url,!0),l=window.location.search;return(l.startsWith("?")||l.startsWith("&"))&&(l=l.substring(1)),isEmptyLadiPage(l)||(u.search=u.search+(isEmptyLadiPage(u.search)?"?":"&")+l),void window.ladi(u.href).open_url()}d=c.message||d}catch(e){}i.showMessage(d)}})}}(t);else if(isObjectLadiPage(c)&&c["option.is_form_checkout"])p({isSendFormCheckout:!0});else if(isObjectLadiPage(c)&&isObjectLadiPage(c["option.form_setting"])&&c["option.form_setting"].is_multiple)c["option.form_setting"].is_multiple_otp?(m(!0),y(!1,function(e){if(e){var t=[];isObjectLadiPage(c["option.form_setting"])&&(t=c["option.form_setting"].mapping_form_id||[]),t.forEach(function(e){var t=document.getElementById(e);if(!isEmptyLadiPage(t)){var n=t.querySelector(".ladi-form-item .button-get-code");isEmptyLadiPage(n)||(t.setAttribute("data-start-countdown-otp",!0),n.click())}})}})):B(t,c,!1,null,{isRunTracking:!0});else{if(i.runtime.shopping_product_type==i.const.FORM_CONFIG_TYPE.ladisales&&!isNullLadiPage(i.runtime.shopping_config_checkout_id)){r=i.findAncestor(t,"ladi-popup");if(!isEmptyLadiPage(r)&&(r=i.findAncestor(r,"ladi-element"),!isEmptyLadiPage(r)&&"POPUP_CHECKOUT"==r.id))return function(e){var t=window.ladi("_cart_token").get_cookie(),a=window.ladi("_checkout_token").get_cookie();_={},g={},f=[],w=[],O=[],F(e,!1);var o=u.email,r=u.phone;if(isEmptyLadiPage(t)||isEmptyLadiPage(a))i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR);else if(isEmptyLadiPage(o)&&isEmptyLadiPage(r))i.showMessage(i.const.LANG.FORM_INPUT_REQUIRED_ERROR);else{var c=u.name,d=u.address,s=u.message,l=u.country||"";l=l.split(":")[0];var p=u.state||"";p=p.split(":")[0];var m=u.district||"";m=m.split(":")[0];var h=u.ward||"";h=h.split(":")[0];var y=u.coupon,v=i.runtime.tmp.add_to_cart_shipping_method_id,E=i.getLadiSaleCheckoutCartProducts(),k={cart_token:t,checkout_token:a,discount_code:y,customer_first_name:c,customer_email:o,customer_phone:r,customer_address:d,customer_note:s,customer_country_code:l,customer_state_id:p,customer_district_id:m,customer_ward_id:h,shipping_method_id:v,shipping_first_name:c,shipping_address:d,shipping_phone:r,shipping_email:o,shipping_country_code:l,shipping_state_id:p,shipping_district_id:m,shipping_ward_id:h,shipping_note:s,checkout_config_id:i.runtime.shopping_config_checkout_id,is_export_invoice:0,is_generate_url:!0,variants:E,source:"LADIPAGE",utm:{url_page:window.location.href}};T=i.getURLSearchParams(null,null,!1),x.forEach(function(e){k.utm[e]=isNullLadiPage(T[e])?"":T[e]}),isNullLadiPage(T[i.const.LADIFLOW_DATA_KEY_NAME])||(k.utm[i.const.LADIFLOW_DATA_KEY_NAME]=T[i.const.LADIFLOW_DATA_KEY_NAME]),i.runtime.has_popupx&&(k.utm.origin_url_page=i.runtime.tmp.popupx_origin_url),isEmptyLadiPage(n)||(k.utm[i.const.REF_NAME]=n),k.custom_fields={};var L=Object.keys(u);(L=L.except(["name","email","phone","address","country","state","district","ward","message","coupon"])).forEach(function(e){k.custom_fields[e]=u[e]}),i.sendRequest("POST",i.const.API_LADISALE_CHECKOUT_CREATE,JSON.stringify(k),!0,{"Content-Type":"application/json"},function(e,t,n){if(n.readyState==XMLHttpRequest.DONE){if(200==t)try{var a=JSON.parse(e);if(200==a.code&&isObjectLadiPage(a.data)&&!isEmptyLadiPage(a.data.url)){var o=window.ladi(a.data.url).get_url(),r=i.getElementAHref(o,!0),c=i.getURLSearchParams(r.search,null,!1);return isEmptyLadiPage(i.runtime.shopping_config_checkout_id)||(c.checkout_config_id=i.runtime.shopping_config_checkout_id),c.ladi_redirect_url=window.location.href,c=Object.keys(c).reduce(function(e,t){return e.push(t+"="+encodeURIComponent(c[t])),e},[]).join("&"),r.search=c,o=r.href,void window.ladi(o).open_url()}if(!isEmptyLadiPage(a.message))return void i.showMessage(a.message)}catch(e){}i.showMessage(i.const.LANG.REQUEST_SEND_ERROR)}})}}(t),!1}p({isFormOtp:!1})}}else{var E=d[s].querySelectorAll('[type="checkbox"]');if(E.length>0){E[0].setAttribute("required","required");for(var k=0;k<E.length;k++)E[k].removeEventListener("change",J),E[k].addEventListener("change",J);t.querySelector(".ladi-form").reportValidity()}}}return!1},$=function(e,t,n,a){var o=i.findAncestor(e.target,"ladi-form");if(!isEmptyLadiPage(o)){var r=i.findAncestor(e.target,"ladi-button");r=i.findAncestor(r||e.target,"ladi-element");var c=i.findAncestor(o,"ladi-element");if(!(isEmptyLadiPage(c)||(n=t?n:i.runtime.eventData[c.id],isEmptyLadiPage(n)||!n["option.is_buy_now"]&&!n["option.is_add_to_cart"]||isEmptyLadiPage(n["option.product_type"])||isEmptyLadiPage(n["option.product_id"])))){var d=function(){var o=i.generateVariantProduct(n,!1,null,null,null,null,!0,!0,d);if(isEmptyLadiPage(o)||isEmptyLadiPage(o.store_info)||isEmptyLadiPage(o.product))isEmptyLadiPage(i.runtime.tmp.timeout_product_info[n["option.product_type"]][n["option.product_id"]])&&i.showMessage(i.const.LANG.ADD_TO_CART_NO_PRODUCT,{name:i.getMessageNameProduct()});else{var s=-1,u=null;if(t){var l=c.querySelector('[data-variant="true"]');u=i.getProductVariantId(l,o.product),isEmptyLadiPage(u)||(s=o.product.variants.findIndex(function(e){return e.product_variant_id==u}))}else s=i.getProductVariantIndex(c.id,n);if(-1!=s){var p=o.product.variants[s].product_id;u=o.product.variants[s].product_variant_id;var m=o.product.name,_=o.product.variants[s].title,g=o.product.variants[s].price,f=o.product.variants[s].quantity,h=o.product.variants[s].quantity_stock;f=isNullLadiPage(h)?f:h;var y=isEmptyLadiPage(o.product.variants[s].src)?"":o.product.variants[s].src;y=isEmptyLadiPage(y)&&isObjectLadiPage(o.product.image)?o.product.image.src:y,isEmptyLadiPage(y)||!isStringLadiPage(y)||y.startsWith("http://")||y.startsWith("https://")||y.startsWith("//")||(y="https://"+i.const.STATIC_W_DOMAIN+"/"+y);if(0==o.product.select_many_service&&isArrayLadiPage(i.runtime.tmp.cart)&&-1!=i.runtime.tmp.cart.findIndex(function(e){return e.product_id==p&&e.product_variant_id!=u&&e.quantity>0}))i.showMessage(i.const.LANG.ADD_TO_CART_PRODUCT_ONLY_ONE,{name:i.getMessageNameProduct(o.product.variants[s])});else{var v=i.runtime.tmp.cart.findIndex(function(e){return e.product_variant_id==u}),E=!1;if(-1==v){E=!0;var k={store_id:o.store_info.id,product_id:p,product_variant_id:u,name:m,title:_,price:g,image:y,quantity:0,min_buy:o.product.variants[s].min_buy,max_buy:o.product.variants[s].max_buy,inventory_checked:o.product.variants[s].inventory_checked,available_quantity:f,currency:o.store_info.currency,product_type:o.product.variants[s].product_type,package_quantity:o.product.variants[s].package_quantity};isObjectLadiPage(k.currency)&&!isEmptyLadiPage(k.currency.code)&&(k.currency.symbol=i.formatCurrency(null,k.currency.code,!1,!0)),i.runtime.tmp.cart.push(k),v=i.runtime.tmp.cart.length-1}var L=c.querySelector('input[name="quantity"]');if(isEmptyLadiPage(L)||isEmptyLadiPage(L.value))i.showMessage(i.const.LANG.ADD_TO_CART_QUANTITY_REQUIRED);else{var P=parseInt(L.value)||0;if(P<=0)return void i.showMessage(i.const.LANG.ADD_TO_CART_QUANTITY_REQUIRED);var b=null,A=1;A=o.product.variants[s].min_buy||A;var w=o.product.variants[s].max_buy;A>i.runtime.tmp.cart[v].quantity+P&&(P=A-i.runtime.tmp.cart[v].quantity);var O=!1;if(!isEmptyLadiPage(w)&&i.runtime.tmp.cart[v].quantity+P>w&&(P=w-i.runtime.tmp.cart[v].quantity)<=0&&(O=!0,b=w),1==o.product.variants[s].inventory_checked){if(A>f)return void i.showMessage(i.const.LANG.ADD_TO_CART_NO_QUANTITY,{name:i.getMessageNameProduct(o.product.variants[s],!0)});i.runtime.tmp.cart[v].quantity+P>f&&(P=f-i.runtime.tmp.cart[v].quantity,f>0&&(O=!0,(isEmptyLadiPage(b)||b>f)&&(b=f)))}if(O||P<=0&&f>0)i.showMessage(i.const.LANG.ADD_TO_CART_MAX_QUANTITY,{max:b,name:i.getMessageNameProduct(o.product.variants[s])},function(){var t=e.target;t=i.findAncestor(t,"ladi-button"),isEmptyLadiPage(t)||(t=i.findAncestor(t,"ladi-element"));var n=i.runtime.eventData[t.id];if(!isEmptyLadiPage(n)){var a=n["option.data_event"];if(!isArrayLadiPage(a)&&(a=[],isObjectLadiPage(n["option.data_action"]))){var o=i.copy(n["option.data_action"]);o.action_type=i.const.ACTION_TYPE.action,a.push(o)}a.forEach(function(e){e.action_type==i.const.ACTION_TYPE.action&&(e.type==i.const.DATA_ACTION_TYPE.popup_cart&&window.ladi("POPUP_CART").show(),e.type==i.const.DATA_ACTION_TYPE.popup_checkout&&(i.runtime.shopping_third_party?i.getThirdPartyCheckoutUrl(!0,null,{event:{target:r}}):window.ladi("POPUP_CHECKOUT").show(!1,{event:{target:r}})))})}});else if(P>0){var S=!isEmptyLadiPage(o.product.variants[s].start_date)&&new Date(o.product.variants[s].start_date).getTime()>Date.now(),T=!isEmptyLadiPage(o.product.variants[s].end_date)&&new Date(o.product.variants[s].end_date).getTime()<Date.now();if(S)i.showMessage(i.const.LANG.ADD_TO_CART_PRODUCT_BEFORE_START_DATE,{name:i.getMessageNameProduct(o.product.variants[s])});else if(T)i.showMessage(i.const.LANG.ADD_TO_CART_PRODUCT_AFTER_END_DATE,{name:i.getMessageNameProduct(o.product.variants[s])});else{var x=function(){i.runtime.tmp.cart[v].quantity+=P;var e={product_id:p,product_variant_id:u,quantity:P};e.product_type=i.runtime.tmp.cart[v].product_type,e.package_quantity=i.runtime.tmp.cart[v].package_quantity;var t=isObjectLadiPage(i.runtime.tmp.cart[v].currency)&&!isEmptyLadiPage(i.runtime.tmp.cart[v].currency.code)?i.runtime.tmp.cart[v].currency.code:i.runtime.currency,n=i.runtime.tmp.cart[v].price;i.addCartCookie(o.store_info.id,e,function(){isFunctionLadiPage(a)&&a();var e=document.getElementsByClassName("ladi-form-remove-coupon")[0];isEmptyLadiPage(e)||e.click(),i.updateCartPromotion(),i.runEventTracking(null,{cart_quantity:P,cart_currency:t,cart_value:n,is_form:!1,is_add_to_cart:!0,is_custom:!0,event:{target:r}})},function(e){i.runtime.tmp.cart[v].quantity-=P,E&&i.runtime.tmp.cart.splice(v,1),i.showMessage(e.message)},function(){LadiPageShopping.push(function(){i.runtime.tmp.generateCart()}),LadiPageShopping.push(function(){i.changeTotalPriceCart()}),i.runtime.tmp.is_click_add_to_cart=!1,0==i.runtime.tmp.cart.length&&-1!=[i.const.FORM_CONFIG_TYPE.ladisales].indexOf(i.runtime.shopping_product_type)&&(window.ladi("_cart_token").delete_cookie(),window.ladi("_checkout_token").delete_cookie()),i.runResizeAll()})};if(isEmptyLadiPage(window.ladi("_cart_token").get_cookie()))if(i.runtime.tmp.is_click_add_to_cart){var N=function(){i.runTimeout(function(){if(i.runtime.tmp.is_click_add_to_cart)return N();d()},100)};N()}else i.runtime.tmp.is_click_add_to_cart=!0,x();else x()}}else f<=0&&i.showMessage(i.const.LANG.ADD_TO_CART_NO_QUANTITY,{name:i.getMessageNameProduct(o.product.variants[s],!0)})}}}else i.showMessage(i.const.LANG.ADD_TO_CART_PRODUCT_REQUIRED,{name:i.getMessageNameProduct(o.product.variants[s])})}};LadiPageShopping.push(function(){d()})}}},V=function(e){$(e,!1,null,function(){var t=i.findAncestor(e.target,"ladi-button");t=i.findAncestor(t||e.target,"ladi-element");var n=i.runtime.eventData[t.id];if(!isEmptyLadiPage(n)){var a=n["option.data_event"];if(!isArrayLadiPage(a)&&(a=[],isObjectLadiPage(n["option.data_action"]))){var o=i.copy(n["option.data_action"]);o.action_type=i.const.ACTION_TYPE.action,a.push(o)}a.forEach(function(e){if(e.action_type==i.const.ACTION_TYPE.action){var n=null;e.type==i.const.DATA_ACTION_TYPE.popup_cart&&(n="POPUP_CART"),e.type==i.const.DATA_ACTION_TYPE.popup_checkout&&(n="POPUP_CHECKOUT"),e.type==i.const.DATA_ACTION_TYPE.popup_checkout&&i.runtime.shopping_third_party?i.getThirdPartyCheckoutUrl(!0,null,{event:{target:t}}):isEmptyLadiPage(n)||window.ladi(n).show(!1,{event:{target:t}})}}),i.runEventTracking(t.id,{is_form:!1})}})},W=function(e){var t=i.findAncestor(e.target,"ladi-form");isEmptyLadiPage(t)||(t=i.findAncestor(t,"ladi-element"),isEmptyLadiPage(t)||window.ladi(t.id).submit())},z=function(e){var t=i.findAncestor(e.target,"ladi-form");if(!isEmptyLadiPage(t)){var n=i.findAncestor(t,"ladi-element");if(!isEmptyLadiPage(n)){i.setEventDataFormDynamic(n.id);var a=i.runtime.eventData[n.id];if(!isEmptyLadiPage(a)){var o={};if(isObjectLadiPage(a["option.form_setting"])&&a["option.form_setting"].is_multiple){if(!a["option.form_setting"].is_multiple_otp)return void B(n,a,!0,e.target.getAttribute("name"),{isRunTracking:!0});o.isFormOtp=!0,o.isCapture=!0}if(a["option.form_auto_capture"]&&(!isEmptyLadiPage(a["option.form_config_id"])||a["option.use_data_leads"])){var r=R(n.id,a["option.form_config_id"]);H(n,{captcha:!0},!0,r,e.target.getAttribute("name"),o)}}}}},Q={};N.forEach(function(e){Q[e]=window.ladi("_ladipage_"+e).get_cookie(),isEmptyLadiPage(Q[e])||(Base64.encode(Base64.decode(Q[e]))==Q[e]?Q[e]=Base64.decode(Q[e]):Q[e]=""),isEmptyLadiPage(Q[e])&&i.removeCookieDomains("_ladipage_"+e),isEmptyLadiPage(t[e])||(Q[e]=t[e])}),a=i.runtime.tmp.convertFormDataObjectCountry(Q);var X=0,Z=!1,ee=function(e){for(var t=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="'+e+'"]'),n=null,o=0;o<t.length;o++){var r=Q[e];if(!isEmptyLadiPage(r)&&"none"!=getComputedStyle(t[o]).display)if("true"!=t[o].getAttribute("data-is-select-country")&&(r=a[e]),"SELECT"==t[o].tagName)t[o].querySelectorAll('option[value="'+r+'"]').length>0&&(t[o].value=r,Z&&i.fireEvent(t[o],"change"));else{if("country"==e&&"true"==t[o].getAttribute("data-is-select-country"))continue;"INPUT"==t[o].tagName&&"true"==t[o].getAttribute("data-is-select-country")&&2==(n=r.split(":")).length&&(r=n[1]),t[o].value=r,Z&&i.fireEvent(t[o],"change")}}},te=function(e){e.target.type="date",e.target.focus()},ne=function(e){isEmptyLadiPage(e.target.value)&&(e.target.type="text")};for(X=0;X<c.length;X++){c[X].onsubmit=K;for(var ae=i.findAncestor(c[X],"ladi-element"),ie=c[X].getElementsByClassName("ladi-button"),oe=0;oe<ie.length;oe++){var re=c[X].getElementsByClassName("ladi-button")[oe];if(!isEmptyLadiPage(re)){var ce=i.findAncestor(re,"ladi-element");isEmptyLadiPage(ae)||isEmptyLadiPage(i.runtime.eventData[ae.id])||!i.runtime.eventData[ae.id]["option.is_add_to_cart"]?ce.addEventListener("click",W):(ce.setAttribute("data-click",!1),ce.addEventListener("click",V))}}var de=c[X].querySelector('[data-is-select-country="true"][name="country"]');if(!isEmptyLadiPage(de)&&"true"==de.getAttribute("data-no-ward")){var se=c[X].querySelector('[data-is-select-country="true"][name="ward"]');isEmptyLadiPage(se)||se.removeAttribute("required")}for(var ue=c[X].querySelectorAll('input[data-type="date"]'),le=0;le<ue.length;le++)isEmptyLadiPage(ue[le].getAttribute("placeholder"))||(ue[le].setAttribute("data-event",!0),i.runtime.isDesktop||i.runtime.isBrowserDesktop?(ue[le].setAttribute("type","text"),ue[le].addEventListener("focus",te),ue[le].addEventListener("blur",ne)):ue[le].value=(new Date).toISOString().substr(0,10));var pe=c[X].querySelectorAll("[tabindex]"),me=0,_e=0;for(le=0;le<pe.length;le++)(_e=parseInt(pe[le].getAttribute("tabindex"))||0)>me&&(me=_e),pe[le].setAttribute("tabindex",i.runtime.tabindexForm+_e);for(pe=c[X].querySelectorAll("[data-tabindex]"),le=0;le<pe.length;le++)(_e=parseInt(pe[le].getAttribute("data-tabindex"))||0)>me&&(me=_e),pe[le].setAttribute("data-tabindex",i.runtime.tabindexForm+_e);i.runtime.tabindexForm+=me;for(var ge=0;ge<C.length;ge++){var fe=c[X].querySelector('.ladi-element .ladi-form-item-container input[name="'+C[ge]+'"]');isEmptyLadiPage(fe)||fe.addEventListener("focusout",z)}}i.runOptionFormCheckout();var he=function(e,t){for(Z=t,X=0;X<c.length;X++){var n=i.findAncestor(c[X],"ladi-element");!isEmptyLadiPage(i.runtime.eventData[n.id])&&i.runtime.eventData[n.id]["option.form_auto_complete"]&&e.forEach(ee)}};he(i.copy(N).except(i.runtime.list_set_value_name_country));LadiPageLocation.push(function(){var e="",t="",n="",a="",o=null,r=function(e,t){var n=String(o[e].name),a=String(o[t].name);try{return n.localeCompare(a)}catch(e){}return n==a?0:n>a?1:-1};document.querySelectorAll('select[name="ward"]').forEach(function(e){e.setAttribute("data-original-required",e.hasAttribute("required")?"1":"0")});var d=function(n){var a=window.LadiLocation[t];if(isObjectLadiPage(a)){var i=a.data[n];isEmptyLadiPage(i)||(e+='<option value="'+i.id+":"+i.name+'">'+i.name+"</option>")}},s=function(e){var t=window.LadiLocation[e.target.getAttribute("data-country")];if(isObjectLadiPage(t)){var a=t.data[e.target.value.split(":")[0]];if(n="",!isEmptyLadiPage(a)&&isObjectLadiPage(a.data)){var c=Object.keys(a.data);o=a.data,c.sort(r),c.forEach(function(e){var t=a.data[e];n+='<option value="'+t.id+":"+t.name+'">'+t.name+"</option>"})}var d=i.findAncestor(e.target,"ladi-element");if(!isEmptyLadiPage(d)){var s=d.querySelector('[name="district"]');isEmptyLadiPage(s)||"SELECT"==s.tagName&&(s.setAttribute("data-selected",""),s.innerHTML=s.querySelector("option").outerHTML+n);var u=d.querySelector('[name="ward"]');isEmptyLadiPage(u)||"SELECT"==u.tagName&&(u.setAttribute("data-selected",""),u.innerHTML=u.querySelector("option").outerHTML),LadiPageShopping.push(function(){i.reloadFeeShipping({target:u})})}}},u=function(e){var t=i.findAncestor(e.target,"ladi-element");if(!isEmptyLadiPage(t)){var n=t.querySelector('[name="ward"]');if(!isEmptyLadiPage(n)){a="";var c=t.querySelector('select[name="state"]');if(!isEmptyLadiPage(c)){var d=c.getAttribute("data-selected");if(!isEmptyLadiPage(d)){d=d.split(":")[0];var s=window.LadiLocation[c.getAttribute("data-country")];if(isObjectLadiPage(s)){var u=s.data[d];if(!isEmptyLadiPage(u)&&isObjectLadiPage(u.data)){var l=u.data[e.target.value.split(":")[0]];if(!isEmptyLadiPage(l)){var p=Object.keys(l.data);o=l.data,p.sort(r),p.forEach(function(e){var t=l.data[e];a+='<option value="'+t.id+":"+t.name+'">'+t.name+"</option>"})}}}}}if("SELECT"==n.tagName){n.setAttribute("data-selected",""),n.innerHTML=n.querySelector("option").outerHTML+a;var m=n.querySelectorAll("option").length;"1"===n.getAttribute("data-original-required")?m<=1?n.removeAttribute("required"):n.setAttribute("required",""):n.removeAttribute("required")}var _=t.querySelector('[name="district"]');isEmptyLadiPage(_)||"SELECT"!=_.tagName||LadiPageShopping.push(function(){i.reloadFeeShipping({target:n})})}}},l=function(e){var t=i.findAncestor(e.target,"ladi-element");if(!isEmptyLadiPage(t)){var n=t.querySelector('[name="ward"]');isEmptyLadiPage(n)||"SELECT"!=n.tagName||LadiPageShopping.push(function(){i.reloadFeeShipping()})}};for(X=0;X<c.length;X++){var p=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="state"]'),m=0,_=null;for(m=0;m<p.length;m++)if(_=i.findAncestor(p[m],"ladi-element"),!isEmptyLadiPage(_)&&(t=i.runtime.eventData[_.id]["option.input_country"],!isEmptyLadiPage(t)&&(e="",t=t.split(":")[0],isObjectLadiPage(window.LadiLocation[t])))){var g=window.LadiLocation[t].data,f=Object.keys(g);o=g,f.sort(r),isArrayLadiPage(i.runtime.country_state_sort[t])&&(f=f.except(i.runtime.country_state_sort[t]),f=i.runtime.country_state_sort[t].concat(f)),f.forEach(d),p[m].setAttribute("data-country",t),p[m].innerHTML=p[m].querySelector("option").outerHTML+e,p[m].removeEventListener("change",s),p[m].addEventListener("change",s)}var h=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="district"]');for(m=0;m<h.length;m++)h[m].removeEventListener("change",u),h[m].addEventListener("change",u);var y=c[X].querySelectorAll('.ladi-element .ladi-form-item-container [name="ward"]');for(m=0;m<y.length;m++)y[m].removeEventListener("change",l),y[m].addEventListener("change",l)}}),LadiPageLocation.push(function(){he(q,!0)}),i.runtime.tmp.buttonAddToCartClick=$,i.runtime.tmp.formMappingFunnelX=function(e,t,n,a){var o=i.runtime.eventData[e],r=document.getElementById(e);if(!isEmptyLadiPage(r)){var c=!1;if(isObjectLadiPage(o)){var d=isObjectLadiPage(o["option.form_setting"])&&o["option.form_setting"].is_multiple;(o["option.form_auto_funnel"]||d)&&(c=!0)}(a||c)&&Object.keys(n).forEach(function(e){var t=r.querySelector('.ladi-form > .ladi-element [name="'+e+'"]');isEmptyLadiPage(t)||(t=i.findAncestor(t,"ladi-element"),window.ladi(t.id).value(n[e]))})}Object.keys(n).forEach(function(e){i.setDataReplaceStr(e,n[e])});var s=null,u=i.findAncestor(r,["ladi-popup","ladi-element"]);isEmptyLadiPage(u)||(s=u.id),i.setDataReplaceElement(!1,!1,null,s)}},LadiPageScriptV2.prototype.setFrequencyFormSubmit=function(e){this.frequencyFormDataByKey({addValue:1,expires:365,key:"submit_form",form_id:e}),this.frequencyFormDataByKey({addValue:1,key:"view",form_id:e}),this.frequencyFormDataByKey({addValue:1,expires:365,key:"guest",form_id:e}),this.frequencyFormDataByKey({addValue:1,key:"session",form_id:e}),this.frequencyFormDataByKey({addValue:1,expires:1/24,key:"hour",form_id:e}),this.frequencyFormDataByKey({addValue:1,expires:1,key:"day",form_id:e}),this.frequencyFormDataByKey({addValue:1,expires:7,key:"week",form_id:e}),this.frequencyFormDataByKey({addValue:1,expires:30,key:"month",form_id:e})},LadiPageScriptV2.prototype.setEventDataFormDynamic=function(e){var t=this;if(isObjectLadiPage(t.runtime.eventData[e])&&!isEmptyLadiPage(t.runtime.eventData[e]["option.dynamic_form_config"]))try{var n=JSON.parse(t.runtime.eventData[e]["option.dynamic_form_config"]);n.configs=isArrayLadiPage(n.configs)?n.configs:[],n.default_actions=isArrayLadiPage(n.default_actions)?n.default_actions:[];for(var a=t.copy(t.runtime.eventData[e]),i=function(e,t,n){var a=!1;"NOT_CONTAINS"!=t&&"NOT_STARTS_WITH"!=t&&"NOT_ENDS_WITH"!=t&&"!="!=t&&"NOT_IN"!=t||(a=!0);var i=isEmptyLadiPage(n)?"":n;i=(i=isStringLadiPage(i)?i:String(i)).toLowerCase();for(var o=0==n?0:parseFloatLadiPage(n)||null,r=0;r<e.length;r++){var c=isEmptyLadiPage(e[r])?"":e[r];c=(c=isStringLadiPage(c)?c:String(c)).toLowerCase();var d=0==e[r]?0:parseFloatLadiPage(e[r])||null;if("CONTAINS"==t&&-1!=i.indexOf(c)){a=!0;break}if("NOT_CONTAINS"==t&&-1!=i.indexOf(c)){a=!1;break}if("STARTS_WITH"==t&&i.startsWith(c)){a=!0;break}if("NOT_STARTS_WITH"==t&&i.startsWith(c)){a=!1;break}if("ENDS_WITH"==t&&i.endsWith(c)){a=!0;break}if("NOT_ENDS_WITH"==t&&i.endsWith(c)){a=!1;break}if(("="==t||"IN"==t)&&i==c){a=!0;break}if(("!="==t||"NOT_IN"==t)&&i==c){a=!1;break}if(!isEmptyLadiPage(d)&&!isEmptyLadiPage(o)){if(">"==t&&o>d){a=!0;break}if(">="==t&&o>=d){a=!0;break}if("<"==t&&o<d){a=!0;break}if("<="==t&&o<=d){a=!0;break}}}return a},o=function(n,a,o){var r=null;try{var c=null;c="state|district|ward"==o?document.querySelector(`#${e} .ladi-element input[data-is-select-country="true"][name="country"]`):document.querySelector(`#${e} .ladi-element [name="${o}"]`);var d=t.findAncestor(c,"ladi-element");r=window.ladi(d.id).value(),isArrayLadiPage(r)&&(r=JSON.stringify(r))}catch(e){}return i(n,a,r)},r=function(e,t,n){var a=LadiPageScript.getURLSearchParams(null,null,!1);return i(e,t,a[n])},c=function(e,t,n){return i(e,t,window.ladi(n).get_cookie())},d=function(e){var t=0,n=e.trim().split(":");return t=60*(parseFloatLadiPage(n[0])||0),t+=parseFloatLadiPage(n[1])||0},s=function(e,t,n){var a=!1;"NOT_FROM_TO"==t&&(a=!0);var i=new Date(n);n=(i.getHours()<10?"0"+i.getHours():i.getHours())+":"+(i.getMinutes()<10?"0"+i.getMinutes():i.getMinutes()),n=d(n);for(var o=0;o<e.length;o++){var r=e[o].split("-"),c=d(r[0]),s=d(r[1]);if("FROM_TO"==t&&n>=c&&n<=s){a=!0;break}if("NOT_FROM_TO"==t&&n>=c&&n<=s){a=!1;break}}return a},u=function(e,t,n){var a=new Date(n);return i(e,t,a.getDay())},l=function(e,n,a){var o=Math.floor((Date.now()-t.runtime.timerefresh)/1e3),r=Math.round((window.scrollY+t.getHeightDevice())/document.body.clientHeight*100);r=r>100?100:r;var c=t.frequencyFormDataByKey({getValue:!0,key:"submit_form"}),d=t.frequencyFormDataByKey({getValue:!0,key:"page_view"});return"form_submit"==a?i(e,n,c):"page_view"==a?i(e,n,d):"time_on_page"==a?i(e,n,o):"scroll_page"==a?i(e,n,r):void 0},p=function(e){return t.frequencyFormDataByKey({getValue:!0,key:e})<1},m=0;m<n.configs.length;m++){var _=n.configs[m];_.actions=isArrayLadiPage(_.actions)?_.actions:[],_.conditions=isArrayLadiPage(_.conditions)?_.conditions:[];for(var g=!0,f=0;f<_.conditions.length&&g;f++){var h=_.conditions[f];"DATA_FIELD"==h.type&&(g=o(h.value,h.operator,h.data_field_value)),"URL"==h.type&&(g=i(h.value,h.operator,window.location.href)),"PARAM"==h.type&&(g=r(h.value,h.operator,h.param_name)),"COOKIE"==h.type&&(g=c(h.value,h.operator,h.cookie_name)),"TIME"==h.type&&(g=s(h.value,h.operator,Date.now())),"DAY"==h.type&&(g=u(h.value,h.operator,Date.now())),"FREQUENCY"==h.type&&(g=p(h.frequency)),"BEHAVIOR"==h.type&&(g=l([h.value],h.operator,h.behavior_type))}if(0==_.conditions.length&&(g=!0),g){n.default_actions=_.actions;break}}var y=isObjectLadiPage(a["option.form_setting"])&&a["option.form_setting"].is_multiple,v=isObjectLadiPage(a["option.form_setting"])&&a["option.form_setting"].is_multiple_otp;delete a["option.thankyou_type"],delete a["option.thankyou_value"],delete a["option.deeplink_value"],y&&(a["option.form_setting"].mapping_form_id=[]),a["option.set_cookie"]=[];var E=function(e){return e.filter(function(e){return!e.autoadd})};n.default_actions.forEach(function(e){v?("form_show_popup_default"==e.type&&(a["option.thankyou_type"]=t.const.FORM_THANKYOU_TYPE.default,a["option.thankyou_value"]=e.text_thankyou_value),"form_redirect_url"==e.type&&(a["option.thankyou_type"]=t.const.FORM_THANKYOU_TYPE.url,a["option.thankyou_value"]=e.redirect_url),"form_open_popup"==e.type&&(a["option.thankyou_type"]=t.const.FORM_THANKYOU_TYPE.popup,a["option.thankyou_value"]=e.id_open_popup),"form_open_app_mobile"==e.type&&(a["option.deeplink_value"]=e.app_link),"form_setup_cookies"==e.type&&a["option.set_cookie"].push(e.cookie_name),"mapping_form"==e.type&&a["option.form_setting"].mapping_form_id.push(e.form_mapping_id)):y?("mapping_form"==e.type&&a["option.form_setting"].mapping_form_id.push(e.form_mapping_id),"form_open_popup"==e.type&&(isArrayLadiPage(a["option.data_event"])||(a["option.data_event"]=[]),a["option.data_event"]=E(a["option.data_event"]),a["option.data_event"].push({autoadd:!0,type:t.const.FORM_THANKYOU_TYPE.popup,action_type:t.const.ACTION_TYPE.complete,action:e.id_open_popup})),"form_next_section"==e.type&&(isArrayLadiPage(a["option.data_event"])||(a["option.data_event"]=[]),a["option.data_event"]=E(a["option.data_event"]),a["option.data_event"].push({autoadd:!0,type:t.const.FORM_THANKYOU_TYPE.section,action_type:t.const.ACTION_TYPE.complete,action:e.id_section_item}))):("form_show_popup_default"==e.type&&(a["option.thankyou_type"]=t.const.FORM_THANKYOU_TYPE.default,a["option.thankyou_value"]=e.text_thankyou_value),"form_redirect_url"==e.type&&(a["option.thankyou_type"]=t.const.FORM_THANKYOU_TYPE.url,a["option.thankyou_value"]=e.redirect_url),"form_open_popup"==e.type&&(a["option.thankyou_type"]=t.const.FORM_THANKYOU_TYPE.popup,a["option.thankyou_value"]=e.id_open_popup),"form_open_app_mobile"==e.type&&(a["option.deeplink_value"]=e.app_link),"form_setup_cookies"==e.type&&a["option.set_cookie"].push(e.cookie_name))}),t.runtime.eventData[e]=a}catch(e){}},LadiPageScriptV2.prototype.setInputOtp=function(){for(var e=this,t=document.querySelectorAll(".ladi-form .ladi-element .ladi-form-otp"),n=function(t,a){var i=e.findAncestor(a,"ladi-form");if(!isEmptyLadiPage(i)&&(i=e.findAncestor(i,"ladi-element"),!isEmptyLadiPage(i))){var o="_otp_time_"+i.id,r=window.ladi(o).get_cookie(),c=e.runtime.tmp["cookie_cache_otp_"+i.id];isEmptyLadiPage(r)&&isObjectLadiPage(c)&&!isEmptyLadiPage(c[o])&&(r=c[o]);var d=(r=parseFloatLadiPage(r)||0)+e.runtime.time_otp-Date.now();d=d<e.runtime.time_otp?d:0,r<=0||d<=0?function(e){e.classList.add("otp-resend"),e.classList.remove("otp-countdown"),e.removeAttribute("data-countdown-time")}(t):(d=Math.ceil(d/1e3),t.classList.remove("otp-resend"),t.classList.add("otp-countdown"),t.setAttribute("data-countdown-time",d),e.runTimeout(function(){n(t,a)},1e3))}},a=function(t){var a=e.findAncestor(t.target,"ladi-form");if(!isEmptyLadiPage(a)&&(a=e.findAncestor(a,"ladi-element"),!isEmptyLadiPage(a))){var i="_otp_time_"+a.id,o=!1,r=e.runtime.tmp["cookie_cache_otp_"+a.id],c=function(){a.removeAttribute("data-start-countdown-otp");var c=new Date;c.setTime(c.getTime()+e.runtime.time_otp),o?(r[i]=Date.now(),e.runtime.tmp["cookie_cache_otp_"+a.id]=r):window.ladi(i).set_cookie(Date.now(),c);var d=e.findAncestor(t.target,"ladi-form-item");e.runTimeout(function(){n(d,t.target)},1);var s=e.copy(e.runtime.tmp.form_data_otp_current);e.runTimeout(function(){isObjectLadiPage(s)&&Object.keys(s).forEach(function(t){try{var n=a.querySelector('.ladi-element [name="'+t+'"]');isEmptyLadiPage(n)||(n=e.findAncestor(n,"ladi-element"),window.ladi(n.id).value(s[t]))}catch(e){}})},300)};if("true"!=a.getAttribute("data-start-countdown-otp")){var d=window.ladi(i).get_cookie();isEmptyLadiPage(d)&&isObjectLadiPage(r)&&!isEmptyLadiPage(r[i])&&(d=r[i],o=!0);var s=(d=parseFloatLadiPage(d)||0)+e.runtime.time_otp-Date.now();s=s<e.runtime.time_otp?s:0,(d<=0||s<=0)&&"true"!=t.target.getAttribute("data-click")&&isFunctionLadiPage(e.runtime.func_get_code_otp[a.id])&&(e.removeTimeout(e.runtime.tmp.timeout_is_wait_popup_id),e.runtime.tmp.is_wait_popup=!0,e.showLoadingBlur(),t.target.setAttribute("data-click",!0),e.runtime.func_get_code_otp[a.id](!0,function(n){t.target.removeAttribute("data-click"),e.hideLoadingBlur(),n&&c(),e.runtime.tmp.timeout_is_wait_popup_id=e.runTimeout(function(){delete e.runtime.tmp.is_wait_popup},200)}))}else c()}},i=0;i<t.length;i++){var o=t[i],r=e.findAncestor(o,"ladi-form-item");if(isEmptyLadiPage(r))continue;r.classList.add("overflow-hidden");var c=r.getElementsByClassName("button-get-code")[0];isEmptyLadiPage(c)&&((c=document.createElement("div")).className="button-get-code",c.innerHTML=e.const.LANG.GET_CODE_BUTTON_TEXT,c.addEventListener("click",a),r.appendChild(c));window.location.href.includes("www.lightupfptschools.vn/binhchon")?c.style.display="none":(c.classList.add("hide-visibility"),o.style.setProperty("padding-right",c.clientWidth+5+"px"),c.classList.remove("hide-visibility"),n(r,c))}},LadiPageScriptV2.prototype.setInputFile=function(){for(var e=this,t=document.querySelectorAll(".ladi-form .ladi-element .ladi-form-control-file"),n=function(t){var n=t.target,a=n.getAttribute("data-click-id")||e.randomId();n.setAttribute("data-click-id",a);var i="ladi-input-file",o=document.getElementById(i);if(isEmptyLadiPage(o)){(o=document.createElement("input")).id=i;var r=e.findAncestor(n,"ladi-element");!isEmptyLadiPage(r)&&r.classList.contains("accept-all")||o.setAttribute("accept",".jpg, .jpeg, .png, .gif, .svg, .ico, .mp3, .mp4, .ttf, .otf, .woff2, .txt, .doc, .docx, .xls, .xlsx, .pdf"),o.setAttribute("style","position: absolute; top: 0; left: 0; visibility: hidden;"),o.multiple=!0,o.type="file",document.body.appendChild(o)}o.setAttribute("data-file-click-id",a),"true"!=o.getAttribute("data-event")&&(o.setAttribute("data-event",!0),o.addEventListener("change",function(t){!function(t,n,a){if(n.length>e.const.FORM_UPLOAD_FILE_LENGTH)e.showMessage(e.const.LANG.FORM_UPLOAD_FILE_MAX_LENGTH_ERROR,{max_length:e.const.FORM_UPLOAD_FILE_LENGTH});else{for(var i=new FormData,o=0,r=0;r<n.length;r++)o+=n[r].size,i.append("file[]",n[r]);if(o>1024*e.const.FORM_UPLOAD_FILE_SIZE*1024)e.showMessage(e.const.LANG.FORM_UPLOAD_FILE_MAX_SIZE_ERROR,{max_size:e.const.FORM_UPLOAD_FILE_SIZE});else{var c={ladipage_id:e.runtime.ladipage_id,lang:e.runtime.lang};i.append("json_data",JSON.stringify(c)),e.showLoadingBlur(),e.sendRequest("POST",e.const.API_FILE_UPLOAD,i,!0,null,function(n,a,i){if(i.readyState==XMLHttpRequest.DONE){if(e.hideLoadingBlur(),200==a)try{var o=JSON.parse(n);if(200==o.code){var r=[],c=[];return o.data.success.forEach(function(e){r.push(e.name),c.push({id:e._id,path:e.path,name:e.name})}),t.value=r.length>0?"["+r.join(", ")+"]":"",void t.setAttribute("data-path-file",JSON.stringify(c))}if(!isEmptyLadiPage(o.message))return void e.showMessage(o.message)}catch(e){}e.showMessage(e.const.LANG.REQUEST_SEND_ERROR)}}),isFunctionLadiPage(a)&&a()}}}(n=document.querySelector('[data-click-id="'+t.target.getAttribute("data-file-click-id")+'"]'),t.target.files,function(){t.target.value=null})})),o.click()},a=0;a<t.length;a++){var i=t[a];i.readOnly=!0,i.style.setProperty("cursor","pointer"),i.addEventListener("click",n)}},LadiPageScriptV2.prototype.runFormItem=function(e,t,n){var a=this;if("form_item"==t){var i=null,o=null;if((n==a.const.INPUT_TYPE.select||n==a.const.INPUT_TYPE.select_multiple)&&(i=document.getElementById(e),!isEmptyLadiPage(i)))for(var r=i.getElementsByClassName("ladi-form-control"),c=0;c<r.length;c++)r[c].addEventListener("change",function(e){e.target.setAttribute("data-selected",e.target.value)}),r[c].addEventListener("focus",a.runFocusInput);if(n==a.const.INPUT_TYPE.radio||n==a.const.INPUT_TYPE.checkbox){i=document.getElementById(e);var d=function(e){e.stopPropagation();var t=a.findAncestor(e.target,"ladi-form-checkbox-item");if(!isEmptyLadiPage(t)){if(n==a.const.INPUT_TYPE.radio){var i=a.findAncestor(t,"ladi-form-checkbox");if(!isEmptyLadiPage(i))for(var o=i.querySelectorAll(".ladi-form-checkbox-item span"),r=0;r<o.length;r++)o[r].setAttribute("data-checked",!1)}t.getElementsByTagName("span")[0].setAttribute("data-checked",e.target.checked)}a.runFormItemOtherChange(t)},s=function(e){e.stopPropagation();var t=a.findAncestor(e.target,"ladi-form-checkbox-item");isEmptyLadiPage(t)||t.getElementsByTagName("input")[0].click()};if(!isEmptyLadiPage(i)){o=i.getElementsByClassName("ladi-form-checkbox-item");for(var u=0;u<o.length;u++){var l=o[u].getElementsByTagName("input")[0];o[u].getElementsByTagName("span")[0].addEventListener("click",s),l.addEventListener("change",d),l.addEventListener("focus",a.runFocusInput)}a.runFormItemOtherChange(o[0])}}}},LadiPageScriptV2.prototype.runFormData=function(e){isFunctionLadiPage(e)&&e()},function(){var e=window.LadiPageFormData||[];window.LadiPageFormData={},window.LadiPageFormData.push=function(e){LadiPageScript.runFormData(e)},e.forEach(function(e){window.LadiPageFormData.push(e)})}();